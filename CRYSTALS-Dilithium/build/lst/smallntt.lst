ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 1


   1              	# 0 "smallntt.S"
   2              	# 1 "C:\\ChibiStudio\\workspace_user\\CRYSTALS-Dilithium//"
   0              	
   0              	
   0              	
   1              	#include "macros.i"
   1              	#ifndef MACROS_I
   2              	#define MACROS_I
   3              	// 3
   4              	.macro montgomery_mul_32 a, b, Qprime, Q, tmp, tmp2
   5              	    smull \tmp, \a, \a, \b
   6              	    mul \tmp2, \tmp, \Qprime
   7              	    smlal \tmp, \a, \tmp2, \Q
   8              	.endm
   9              	
  10              	// 2
  11              	.macro addSub1 c0, c1
  12              	    add.w \c0, \c1
  13              	    sub.w \c1, \c0, \c1, lsl #1
  14              	.endm
  15              	
  16              	// 3
  17              	.macro addSub2 c0, c1, c2, c3
  18              	    add \c0, \c1
  19              	    add \c2, \c3
  20              	    sub.w \c1, \c0, \c1, lsl #1
  21              	    sub.w \c3, \c2, \c3, lsl #1
  22              	.endm
  23              	
  24              	// 6
  25              	.macro addSub4 c0, c1, c2, c3, c4, c5, c6, c7
  26              	    add \c0, \c1
  27              	    add \c2, \c3
  28              	    add \c4, \c5
  29              	    add \c6, \c7
  30              	    sub.w \c1, \c0, \c1, lsl #1
  31              	    sub.w \c3, \c2, \c3, lsl #1
  32              	    sub.w \c5, \c4, \c5, lsl #1
  33              	    sub.w \c7, \c6, \c7, lsl #1
  34              	.endm
  35              	
  36              	.macro _2_layer_CT_32 c0, c1, c2, c3, zeta0, zeta1, zeta2, Qprime, Q, tmp, tmp2
  37              	    montgomery_mul_32 \c2, \zeta0, \Qprime, \Q, \tmp, \tmp2
  38              	    montgomery_mul_32 \c3, \zeta0, \Qprime, \Q, \tmp, \tmp2
  39              	    addSub2 \c0, \c2, \c1, \c3
  40              	
  41              	    montgomery_mul_32 \c1, \zeta1, \Qprime, \Q, \tmp, \tmp2
  42              	    montgomery_mul_32 \c3, \zeta2, \Qprime, \Q, \tmp, \tmp2
  43              	    addSub2 \c0, \c1, \c2, \c3
  44              	.endm
  45              	
  46              	.macro _2_layer_inv_CT_32 c0, c1, c2, c3, zeta0, zeta1, zeta2, Qprime, Q, tmp, tmp2
  47              	    montgomery_mul_32 \c1, \zeta0, \Qprime, \Q, \tmp, \tmp2
  48              	    montgomery_mul_32 \c3, \zeta0, \Qprime, \Q, \tmp, \tmp2
  49              	    addSub2 \c0, \c1, \c2, \c3
  50              	
  51              	    montgomery_mul_32 \c2, \zeta1, \Qprime, \Q, \tmp, \tmp2
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 2


  52              	    montgomery_mul_32 \c3, \zeta2, \Qprime, \Q, \tmp, \tmp2
  53              	    addSub2 \c0, \c2, \c1, \c3
  54              	.endm
  55              	
  56              	.macro _3_layer_CT_32 c0, c1, c2, c3, c4, c5, c6, c7, xi0, xi1, xi2, xi3, xi4, xi5, xi6, twiddle, Q
  57              	    vmov.w \twiddle, \xi0
  58              	    montgomery_mul_32 \c4, \twiddle, \Qprime, \Q, \tmp, \tmp2
  59              	    montgomery_mul_32 \c5, \twiddle, \Qprime, \Q, \tmp, \tmp2
  60              	    montgomery_mul_32 \c6, \twiddle, \Qprime, \Q, \tmp, \tmp2
  61              	    montgomery_mul_32 \c7, \twiddle, \Qprime, \Q, \tmp, \tmp2
  62              	    addSub4 \c0, \c4, \c1, \c5, \c2, \c6, \c3, \c7
  63              	
  64              	    vmov.w \twiddle, \xi1
  65              	    montgomery_mul_32 \c2, \twiddle, \Qprime, \Q, \tmp, \tmp2
  66              	    montgomery_mul_32 \c3, \twiddle, \Qprime, \Q, \tmp, \tmp2
  67              	    vmov.w \twiddle, \xi2
  68              	    montgomery_mul_32 \c6, \twiddle, \Qprime, \Q, \tmp, \tmp2
  69              	    montgomery_mul_32 \c7, \twiddle, \Qprime, \Q, \tmp, \tmp2
  70              	    addSub4 \c0, \c2, \c1, \c3, \c4, \c6, \c5, \c7
  71              	
  72              	    vmov.w \twiddle, \xi3
  73              	    montgomery_mul_32 \c1, \twiddle, \Qprime, \Q, \tmp, \tmp2
  74              	    vmov.w \twiddle, \xi4
  75              	    montgomery_mul_32 \c3, \twiddle, \Qprime, \Q, \tmp, \tmp2
  76              	    vmov.w \twiddle, \xi5
  77              	    montgomery_mul_32 \c5, \twiddle, \Qprime, \Q, \tmp, \tmp2
  78              	    vmov.w \twiddle, \xi6
  79              	    montgomery_mul_32 \c7, \twiddle, \Qprime, \Q, \tmp, \tmp2
  80              	    addSub4 \c0, \c1, \c2, \c3, \c4, \c5, \c6, \c7
  81              	.endm
  82              	
  83              	.macro _3_layer_inv_CT_32 c0, c1, c2, c3, c4, c5, c6, c7, xi0, xi1, xi2, xi3, xi4, xi5, xi6, twiddl
  84              	    vmov.w \twiddle, \xi0
  85              	    montgomery_mul_32 \c1, \twiddle, \Qprime, \Q, \tmp, \tmp2
  86              	    montgomery_mul_32 \c3, \twiddle, \Qprime, \Q, \tmp, \tmp2
  87              	    montgomery_mul_32 \c5, \twiddle, \Qprime, \Q, \tmp, \tmp2
  88              	    montgomery_mul_32 \c7, \twiddle, \Qprime, \Q, \tmp, \tmp2
  89              	    addSub4 \c0, \c1, \c2, \c3, \c4, \c5, \c6, \c7
  90              	
  91              	    vmov.w \twiddle, \xi1
  92              	    montgomery_mul_32 \c2, \twiddle, \Qprime, \Q, \tmp, \tmp2
  93              	    montgomery_mul_32 \c6, \twiddle, \Qprime, \Q, \tmp, \tmp2
  94              	    vmov.w \twiddle, \xi2
  95              	    montgomery_mul_32 \c3, \twiddle, \Qprime, \Q, \tmp, \tmp2
  96              	    montgomery_mul_32 \c7, \twiddle, \Qprime, \Q, \tmp, \tmp2
  97              	    addSub4 \c0, \c2, \c1, \c3, \c4, \c6, \c5, \c7
  98              	
  99              	    vmov.w \twiddle, \xi3
 100              	    montgomery_mul_32 \c4, \twiddle, \Qprime, \Q, \tmp, \tmp2
 101              	    vmov.w \twiddle, \xi4
 102              	    montgomery_mul_32 \c5, \twiddle, \Qprime, \Q, \tmp, \tmp2
 103              	    vmov.w \twiddle, \xi5
 104              	    montgomery_mul_32 \c6, \twiddle, \Qprime, \Q, \tmp, \tmp2
 105              	    vmov.w \twiddle, \xi6
 106              	    montgomery_mul_32 \c7, \twiddle, \Qprime, \Q, \tmp, \tmp2
 107              	    addSub4 \c0, \c4, \c1, \c5, \c2, \c6, \c3, \c7
 108              	.endm
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 3


 109              	
 110              	/************************************************************
 111              	* Name:         _3_layer_inv_butterfly_light_fast_first
 112              	*
 113              	* Description:  upper half of 3-layer inverse butterfly
 114              	*               defined over X^8 - 1
 115              	*
 116              	* Input:        (c4, c1, c6, c3) = coefficients on the upper half;
 117              	*               (xi0, xi1, xi2, xi3, xi4, xi5, xi6) =
 118              	*               (  1,  1,  w_4,   1, w_8, w_4, w_8^3) in
 119              	*               Montgomery domain
 120              	*
 121              	* Symbols:      R = 2^32
 122              	*
 123              	* Constants:    Qprime = -MOD^{-1} mod^{+-} R, Q = MOD
 124              	*
 125              	* Output:
 126              	*               c4 =  c4 + c1        + (c6 + c3)
 127              	*               c5 = (c4 - c1) w_4   + (c6 + c3) w_8^3
 128              	*               c6 =  c4 + c1        - (c6 + c3)
 129              	*               c7 = (c4 - c1) w_8^3 + (c6 + c3) w_4
 130              	************************************************************/
 131              	// 15
 132              	.macro _3_layer_inv_butterfly_light_fast_first c0, c1, c2, c3, c4, c5, c6, c7, xi0, xi1, xi2, xi3, 
 133              	    addSub2 \c4, \c1, \c6, \c3
 134              	    addSub1 \c4, \c6
 135              	
 136              	    vmov.w \tmp, \xi4
 137              	    vmov.w \tmp2, \xi6
 138              	
 139              	    smull.w \c0, \c5, \c1, \tmp
 140              	    smlal.w \c0, \c5, \c3, \tmp2
 141              	    mul.w \twiddle, \c0, \Qprime
 142              	    smlal.w \c0, \c5, \twiddle, \Q
 143              	
 144              	    smull.w \c2, \c7, \c1, \tmp2
 145              	    smlal.w \c2, \c7, \c3, \tmp
 146              	    mul.w \twiddle, \c2, \Qprime
 147              	    smlal.w \c2, \c7, \twiddle, \Q
 148              	.endm
 149              	
 150              	/************************************************************
 151              	* Name:         _3_layer_inv_butterfly_light_fast_second
 152              	*
 153              	* Description:  lower half of 3-layer inverse butterfly
 154              	*               defined over X^8 - 1, and the 2nd
 155              	*               layer of butterflies
 156              	*
 157              	* Input:
 158              	*               (c4, c5, c6, c7) = results of the upper half;
 159              	*               (c0, c1, c2, c3) = coefficients on the lower half;
 160              	*               (xi0, xi1, xi2, xi3, xi4, xi5, xi6) =
 161              	*               (  1,  1,  w_4,   1, w_8, w_4, w_8^3) in
 162              	*               Montgomery domain
 163              	*
 164              	* Symbols:      R = 2^32
 165              	*
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 4


 166              	* Constants:    Qprime = -MOD^{-1} mod^{+-} R, Q = MOD
 167              	*
 168              	* Output:       (normal order)
 169              	*               c0 =   c0 + c1     + (c2 + c3)         + (  c4 + c5     + (c6 + c7)       )
 170              	*               c1 =  (c0 - c1) w3 + (c2 - c3)  w4     + ( (c4 - c5) w5 + (c6 - c7) w6    )
 171              	*               c2 = ( c0 + c1     - (c2 + c3)) w1     + (( c4 + c5     - (c6 + c7)   ) w2)
 172              	*               c3 = ((c0 - c1) w3 - (c2 - c3)  w4) w1 + (((c4 - c5) w5 - (c6 - c7) w6) w2)
 173              	*               c4 =   c0 + c1     - (c2 + c3)         - (  c4 + c5     + (c6 + c7)       ) w0
 174              	*               c5 =  (c0 - c1) w3 + (c2 - c3)  w4     - ( (c4 - c5) w5 + (c6 - c7) w6    ) w0
 175              	*               c6 = ( c0 + c1     - (c2 + c3)) w1     - (( c4 + c5     - (c6 + c7)   ) w2) w0
 176              	*               c7 = ((c0 - c1) w3 - (c2 - c3)  w4) w1 - (((c4 - c5) w5 - (c6 - c7) w6) w2) w0
 177              	************************************************************/
 178              	// 19
 179              	.macro _3_layer_inv_butterfly_light_fast_second c0, c1, c2, c3, c4, c5, c6, c7, xi0, xi1, xi2, xi3,
 180              	    addSub2 \c0, \c1, \c2, \c3
 181              	
 182              	    vmov.w \twiddle, \xi2
 183              	    montgomery_mul_32 \c3, \twiddle, \Qprime, \Q, \tmp, \tmp2
 184              	    addSub2 \c0, \c2, \c1, \c3
 185              	
 186              	    montgomery_mul_32 \c6, \twiddle, \Qprime, \Q, \tmp, \tmp2
 187              	
 188              	    addSub4 \c0, \c4, \c1, \c5, \c2, \c6, \c3, \c7
 189              	.endm
 190              	
   2              	
   3              	.syntax unified
   4              	.cpu cortex-m4
   5              	.thumb
   6              	
   7              	// general macros
   8              	.macro load a, a0, a1, a2, a3, mem0, mem1, mem2, mem3
   9              	  ldr.w \a0, [\a, \mem0]
  10              	  ldr.w \a1, [\a, \mem1]
  11              	  ldr.w \a2, [\a, \mem2]
  12              	  ldr.w \a3, [\a, \mem3]
  13              	.endm
  14              	
  15              	.macro store a, a0, a1, a2, a3, mem0, mem1, mem2, mem3
  16              	  str.w \a0, [\a, \mem0]
  17              	  str.w \a1, [\a, \mem1]
  18              	  str.w \a2, [\a, \mem2]
  19              	  str.w \a3, [\a, \mem3]
  20              	.endm
  21              	
  22              	.macro montgomery q, qinv, a, tmp
  23              	  smulbt \tmp, \a, \qinv
  24              	  smlabb \tmp, \q, \tmp, \a
  25              	.endm
  26              	
  27              	.macro montgomery_inplace q, qinv, a, tmp
  28              	  smulbt \tmp, \a, \qinv
  29              	  smlabb \a, \q, \tmp, \a
  30              	.endm
  31              	
  32              	.macro doublemontgomery a, tmp, tmp2, q, qinv, montconst
  33              	  smulbb \tmp2, \a, \montconst
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 5


  34              	  montgomery \q, \qinv, \tmp2, \tmp
  35              	  smultb \a, \a, \montconst
  36              	  montgomery \q, \qinv, \a, \tmp2
  37              	  pkhtb \a, \tmp2, \tmp, asr#16
  38              	.endm
  39              	
  40              	// #######
  41              	// #######
  42              	// # NTT #
  43              	// #######
  44              	// #######
  45              	
  46              	.macro mul_twiddle tb, a, twiddle, tmp, tmp2, q, qinv
  47              	    smulb\tb \tmp, \a, \twiddle
  48              	    smult\tb \a, \a, \twiddle
  49              	    montgomery \q, \qinv, \tmp, \tmp2 // reduce -> result in tmp2
  50              	    montgomery \q, \qinv, \a, \tmp // reduce -> result in tmp2
  51              	    pkhtb \a, \tmp, \tmp2, asr#16 // combine results from above in one register as 16bit halves
  52              	.endm
  53              	
  54              	.macro doublebutterfly tb, a0, a1, twiddle, tmp, tmp2, q, qinv
  55              	  smulb\tb \tmp, \a1, \twiddle // a1_b * twiddle_tb
  56              	  smult\tb \a1, \a1, \twiddle // a1_t * twiddle_tb
  57              	  montgomery \q, \qinv, \tmp, \tmp2 // reduce -> result in tmp2
  58              	  montgomery \q, \qinv, \a1, \tmp // reduce -> result in tmp
  59              	  pkhtb \tmp2, \tmp, \tmp2, asr#16 // combine results from above in one register as 16bit halves
  60              	  usub16 \a1, \a0, \tmp2 // a0 - a1 * twiddle (a0, a1 contain 2 coeffs)
  61              	  uadd16 \a0, \a0, \tmp2 // a0 + a1 * twiddle (a0, a1 contain 2 coeffs)
  62              	.endm
  63              	
  64              	.macro two_doublebutterfly tb1, tb2, a0, a1, a2, a3, twiddle, tmp, tmp2, q, qinv
  65              	  doublebutterfly \tb1, \a0, \a1, \twiddle, \tmp, \tmp2, \q, \qinv
  66              	  doublebutterfly \tb2, \a2, \a3, \twiddle, \tmp, \tmp2, \q, \qinv
  67              	.endm
  68              	
  69              	.macro _3_layer_double_CT_16 c0, c1, c2, c3, c4, c5, c6, c7, twiddle, twiddle_ptr, Qprime, Q, tmp, 
  70              	    // layer 3
  71              	    ldrh.w \twiddle, [\twiddle_ptr], #2
  72              	    two_doublebutterfly b, b, \c0, \c4, \c1, \c5, \twiddle, \tmp, \tmp2, \Q, \Qprime
  73              	    two_doublebutterfly b, b, \c2, \c6, \c3, \c7, \twiddle, \tmp, \tmp2, \Q, \Qprime
  74              	
  75              	    // layer 2
  76              	    ldr.w \twiddle, [\twiddle_ptr], #4
  77              	    two_doublebutterfly b, b, \c0, \c2, \c1, \c3, \twiddle, \tmp, \tmp2, \Q, \Qprime
  78              	
  79              	    two_doublebutterfly t, t, \c4, \c6, \c5, \c7, \twiddle, \tmp, \tmp2, \Q, \Qprime
  80              	
  81              	    // layer 1
  82              	    ldr.w \twiddle, [\twiddle_ptr], #4
  83              	    two_doublebutterfly b, t, \c0, \c1, \c2, \c3, \twiddle, \tmp, \tmp2, \Q, \Qprime
  84              	
  85              	    ldr.w \twiddle, [\twiddle_ptr], #4
  86              	    two_doublebutterfly b, t, \c4, \c5, \c6, \c7, \twiddle, \tmp, \tmp2, \Q, \Qprime
  87              	.endm
  88              	
  89              	.macro _3_layer_double_CT_16_fp c0, c1, c2, c3, c4, c5, c6, c7, xi01, xi23, xi45, xi67, twiddle, Qp
  90              	    // layer 3
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 6


  91              	    vmov \twiddle, \xi01
  92              	    two_doublebutterfly t, t, \c0, \c4, \c1, \c5, \twiddle, \tmp, \tmp2, \Q, \Qprime
  93              	    two_doublebutterfly t, t, \c2, \c6, \c3, \c7, \twiddle, \tmp, \tmp2, \Q, \Qprime
  94              	
  95              	    // layer 2
  96              	    vmov \twiddle, \xi23
  97              	    two_doublebutterfly b, b, \c0, \c2, \c1, \c3, \twiddle, \tmp, \tmp2, \Q, \Qprime
  98              	
  99              	    two_doublebutterfly t, t, \c4, \c6, \c5, \c7, \twiddle, \tmp, \tmp2, \Q, \Qprime
 100              	
 101              	    // layer 1
 102              	    vmov \twiddle, \xi45
 103              	    two_doublebutterfly b, t, \c0, \c1, \c2, \c3, \twiddle, \tmp, \tmp2, \Q, \Qprime
 104              	
 105              	    vmov \twiddle, \xi67
 106              	    two_doublebutterfly b, t, \c4, \c5, \c6, \c7, \twiddle, \tmp, \tmp2, \Q, \Qprime
 107              	.endm
 108              	
 109              	.global small_ntt_asm
 110              	.type small_ntt_asm, %function
 111              	.align 2
 112              	small_ntt_asm:
 113 0000 2DE9F04F 	  push {r4-r11, r14}
 114 0004 2DED018A 	  vpush.w {s16}
 115              	
 116              	  poly        .req r0
 117              	  twiddle_ptr .req r1
 118              	  poly0       .req r2
 119              	  poly1       .req r3
 120              	  poly2       .req r4
 121              	  poly3       .req r5
 122              	  poly4       .req r6
 123              	  poly5       .req r7
 124              	  poly6       .req r8
 125              	  poly7       .req r9
 126              	  twiddle     .req r10
 127              	  qinv        .req r11
 128              	  q           .req r11
 129              	  tmp         .req r12
 130              	  tmp2        .req r14
 131              	
 132 0008 40F2013B 	  movw q, #769
 133 000c C0F2FF2B 	  movt qinv, #767
 134              	
 135              	  ### LAYER 7+6+5+4
 136              	  .equ distance, 256
 137              	  .equ offset, 32
 138              	  .equ strincr, 4
 139              	  // pre-load twiddle factors to FPU registers
 140 0010 B1EC084A 	  vldm twiddle_ptr!, {s8-s15}
 141              	
 142              	
 143 0014 00F1200C 	  add tmp, poly, #strincr*8
 144 0018 08EE10CA 	  vmov s16, tmp
 145              	  1:
 146              	    // load a1, a3, ..., a15
 147              	    load poly, poly0, poly1, poly2, poly3, #offset, #distance/4+offset, #2*distance/4+offset, #3*di
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 7


 147 001c D0F82020 	>  ldr.w poly0,[poly,#offset]
 147 0020 D0F86030 	>  ldr.w poly1,[poly,#distance/4+offset]
 147 0024 D0F8A040 	>  ldr.w poly2,[poly,#2*distance/4+offset]
 147 0028 D0F8E050 	>  ldr.w poly3,[poly,#3*distance/4+offset]
 148              	    load poly, poly4, poly5, poly6, poly7, #distance+offset, #5*distance/4+offset, #6*distance/4+of
 148 002c D0F82061 	>  ldr.w poly4,[poly,#distance+offset]
 148 0030 D0F86071 	>  ldr.w poly5,[poly,#5*distance/4+offset]
 148 0034 D0F8A081 	>  ldr.w poly6,[poly,#6*distance/4+offset]
 148 0038 D0F8E091 	>  ldr.w poly7,[poly,#7*distance/4+offset]
 149              	
 150              	    // 8-NTT on a1, a3, ..., a15
 151              	    _3_layer_double_CT_16_fp poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, s8, s9, s10, s
 151              	> 
 151 003c 14EE10AA 	>  vmov twiddle,s8
 151              	>  two_doublebutterfly t,t,poly0,poly4,poly1,poly5,twiddle,tmp,tmp2,q,qinv
 151              	>>  doublebutterfly t,poly0,poly4,twiddle,tmp,tmp2,q,qinv
 151 0040 16FB1AFC 	>>>  smulbt tmp,poly4,twiddle
 151 0044 16FB3AF6 	>>>  smultt poly4,poly4,twiddle
 151              	>>>  montgomery q,qinv,tmp,tmp2
 151 0048 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 151 004c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 151              	>>>  montgomery q,qinv,poly4,tmp
 151 0050 16FB1BFC 	>>>>  smulbt tmp,poly4,qinv
 151 0054 1BFB0C6C 	>>>>  smlabb tmp,q,tmp,poly4
 151 0058 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 151 005c D2FA4EF6 	>>>  usub16 poly4,poly0,tmp2
 151 0060 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 151              	>>  doublebutterfly t,poly1,poly5,twiddle,tmp,tmp2,q,qinv
 151 0064 17FB1AFC 	>>>  smulbt tmp,poly5,twiddle
 151 0068 17FB3AF7 	>>>  smultt poly5,poly5,twiddle
 151              	>>>  montgomery q,qinv,tmp,tmp2
 151 006c 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 151 0070 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 151              	>>>  montgomery q,qinv,poly5,tmp
 151 0074 17FB1BFC 	>>>>  smulbt tmp,poly5,qinv
 151 0078 1BFB0C7C 	>>>>  smlabb tmp,q,tmp,poly5
 151 007c CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 151 0080 D3FA4EF7 	>>>  usub16 poly5,poly1,tmp2
 151 0084 93FA4EF3 	>>>  uadd16 poly1,poly1,tmp2
 151              	>  two_doublebutterfly t,t,poly2,poly6,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 151              	>>  doublebutterfly t,poly2,poly6,twiddle,tmp,tmp2,q,qinv
 151 0088 18FB1AFC 	>>>  smulbt tmp,poly6,twiddle
 151 008c 18FB3AF8 	>>>  smultt poly6,poly6,twiddle
 151              	>>>  montgomery q,qinv,tmp,tmp2
 151 0090 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 151 0094 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 151              	>>>  montgomery q,qinv,poly6,tmp
 151 0098 18FB1BFC 	>>>>  smulbt tmp,poly6,qinv
 151 009c 1BFB0C8C 	>>>>  smlabb tmp,q,tmp,poly6
 151 00a0 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 151 00a4 D4FA4EF8 	>>>  usub16 poly6,poly2,tmp2
 151 00a8 94FA4EF4 	>>>  uadd16 poly2,poly2,tmp2
 151              	>>  doublebutterfly t,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 151 00ac 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 151 00b0 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 151              	>>>  montgomery q,qinv,tmp,tmp2
 151 00b4 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 8


 151 00b8 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 151              	>>>  montgomery q,qinv,poly7,tmp
 151 00bc 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 151 00c0 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 151 00c4 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 151 00c8 D5FA4EF9 	>>>  usub16 poly7,poly3,tmp2
 151 00cc 95FA4EF5 	>>>  uadd16 poly3,poly3,tmp2
 151              	> 
 151              	> 
 151 00d0 14EE90AA 	>  vmov twiddle,s9
 151              	>  two_doublebutterfly b,b,poly0,poly2,poly1,poly3,twiddle,tmp,tmp2,q,qinv
 151              	>>  doublebutterfly b,poly0,poly2,twiddle,tmp,tmp2,q,qinv
 151 00d4 14FB0AFC 	>>>  smulbb tmp,poly2,twiddle
 151 00d8 14FB2AF4 	>>>  smultb poly2,poly2,twiddle
 151              	>>>  montgomery q,qinv,tmp,tmp2
 151 00dc 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 151 00e0 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 151              	>>>  montgomery q,qinv,poly2,tmp
 151 00e4 14FB1BFC 	>>>>  smulbt tmp,poly2,qinv
 151 00e8 1BFB0C4C 	>>>>  smlabb tmp,q,tmp,poly2
 151 00ec CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 151 00f0 D2FA4EF4 	>>>  usub16 poly2,poly0,tmp2
 151 00f4 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 151              	>>  doublebutterfly b,poly1,poly3,twiddle,tmp,tmp2,q,qinv
 151 00f8 15FB0AFC 	>>>  smulbb tmp,poly3,twiddle
 151 00fc 15FB2AF5 	>>>  smultb poly3,poly3,twiddle
 151              	>>>  montgomery q,qinv,tmp,tmp2
 151 0100 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 151 0104 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 151              	>>>  montgomery q,qinv,poly3,tmp
 151 0108 15FB1BFC 	>>>>  smulbt tmp,poly3,qinv
 151 010c 1BFB0C5C 	>>>>  smlabb tmp,q,tmp,poly3
 151 0110 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 151 0114 D3FA4EF5 	>>>  usub16 poly3,poly1,tmp2
 151 0118 93FA4EF3 	>>>  uadd16 poly1,poly1,tmp2
 151              	> 
 151              	>  two_doublebutterfly t,t,poly4,poly6,poly5,poly7,twiddle,tmp,tmp2,q,qinv
 151              	>>  doublebutterfly t,poly4,poly6,twiddle,tmp,tmp2,q,qinv
 151 011c 18FB1AFC 	>>>  smulbt tmp,poly6,twiddle
 151 0120 18FB3AF8 	>>>  smultt poly6,poly6,twiddle
 151              	>>>  montgomery q,qinv,tmp,tmp2
 151 0124 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 151 0128 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 151              	>>>  montgomery q,qinv,poly6,tmp
 151 012c 18FB1BFC 	>>>>  smulbt tmp,poly6,qinv
 151 0130 1BFB0C8C 	>>>>  smlabb tmp,q,tmp,poly6
 151 0134 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 151 0138 D6FA4EF8 	>>>  usub16 poly6,poly4,tmp2
 151 013c 96FA4EF6 	>>>  uadd16 poly4,poly4,tmp2
 151              	>>  doublebutterfly t,poly5,poly7,twiddle,tmp,tmp2,q,qinv
 151 0140 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 151 0144 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 151              	>>>  montgomery q,qinv,tmp,tmp2
 151 0148 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 151 014c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 151              	>>>  montgomery q,qinv,poly7,tmp
 151 0150 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 9


 151 0154 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 151 0158 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 151 015c D7FA4EF9 	>>>  usub16 poly7,poly5,tmp2
 151 0160 97FA4EF7 	>>>  uadd16 poly5,poly5,tmp2
 151              	> 
 151              	> 
 151 0164 15EE10AA 	>  vmov twiddle,s10
 151              	>  two_doublebutterfly b,t,poly0,poly1,poly2,poly3,twiddle,tmp,tmp2,q,qinv
 151              	>>  doublebutterfly b,poly0,poly1,twiddle,tmp,tmp2,q,qinv
 151 0168 13FB0AFC 	>>>  smulbb tmp,poly1,twiddle
 151 016c 13FB2AF3 	>>>  smultb poly1,poly1,twiddle
 151              	>>>  montgomery q,qinv,tmp,tmp2
 151 0170 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 151 0174 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 151              	>>>  montgomery q,qinv,poly1,tmp
 151 0178 13FB1BFC 	>>>>  smulbt tmp,poly1,qinv
 151 017c 1BFB0C3C 	>>>>  smlabb tmp,q,tmp,poly1
 151 0180 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 151 0184 D2FA4EF3 	>>>  usub16 poly1,poly0,tmp2
 151 0188 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 151              	>>  doublebutterfly t,poly2,poly3,twiddle,tmp,tmp2,q,qinv
 151 018c 15FB1AFC 	>>>  smulbt tmp,poly3,twiddle
 151 0190 15FB3AF5 	>>>  smultt poly3,poly3,twiddle
 151              	>>>  montgomery q,qinv,tmp,tmp2
 151 0194 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 151 0198 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 151              	>>>  montgomery q,qinv,poly3,tmp
 151 019c 15FB1BFC 	>>>>  smulbt tmp,poly3,qinv
 151 01a0 1BFB0C5C 	>>>>  smlabb tmp,q,tmp,poly3
 151 01a4 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 151 01a8 D4FA4EF5 	>>>  usub16 poly3,poly2,tmp2
 151 01ac 94FA4EF4 	>>>  uadd16 poly2,poly2,tmp2
 151              	> 
 151 01b0 15EE90AA 	>  vmov twiddle,s11
 151              	>  two_doublebutterfly b,t,poly4,poly5,poly6,poly7,twiddle,tmp,tmp2,q,qinv
 151              	>>  doublebutterfly b,poly4,poly5,twiddle,tmp,tmp2,q,qinv
 151 01b4 17FB0AFC 	>>>  smulbb tmp,poly5,twiddle
 151 01b8 17FB2AF7 	>>>  smultb poly5,poly5,twiddle
 151              	>>>  montgomery q,qinv,tmp,tmp2
 151 01bc 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 151 01c0 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 151              	>>>  montgomery q,qinv,poly5,tmp
 151 01c4 17FB1BFC 	>>>>  smulbt tmp,poly5,qinv
 151 01c8 1BFB0C7C 	>>>>  smlabb tmp,q,tmp,poly5
 151 01cc CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 151 01d0 D6FA4EF7 	>>>  usub16 poly5,poly4,tmp2
 151 01d4 96FA4EF6 	>>>  uadd16 poly4,poly4,tmp2
 151              	>>  doublebutterfly t,poly6,poly7,twiddle,tmp,tmp2,q,qinv
 151 01d8 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 151 01dc 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 151              	>>>  montgomery q,qinv,tmp,tmp2
 151 01e0 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 151 01e4 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 151              	>>>  montgomery q,qinv,poly7,tmp
 151 01e8 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 151 01ec 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 151 01f0 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 10


 151 01f4 D8FA4EF9 	>>>  usub16 poly7,poly6,tmp2
 151 01f8 98FA4EF8 	>>>  uadd16 poly6,poly6,tmp2
 152              	
 153              	    // multiply coeffs by layer 4 twiddles for later use
 154 01fc 16EE10AA 	    vmov twiddle, s12
 155              	    mul_twiddle b, poly0, twiddle, tmp, tmp2, q, qinv
 155 0200 12FB0AFC 	>  smulbb tmp,poly0,twiddle
 155 0204 12FB2AF2 	>  smultb poly0,poly0,twiddle
 155              	>  montgomery q,qinv,tmp,tmp2
 155 0208 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 155 020c 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 155              	>  montgomery q,qinv,poly0,tmp
 155 0210 12FB1BFC 	>>  smulbt tmp,poly0,qinv
 155 0214 1BFB0C2C 	>>  smlabb tmp,q,tmp,poly0
 155 0218 CCEA2E42 	>  pkhtb poly0,tmp,tmp2,asr#16
 156              	    mul_twiddle t, poly1, twiddle, tmp, tmp2, q, qinv
 156 021c 13FB1AFC 	>  smulbt tmp,poly1,twiddle
 156 0220 13FB3AF3 	>  smultt poly1,poly1,twiddle
 156              	>  montgomery q,qinv,tmp,tmp2
 156 0224 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 156 0228 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 156              	>  montgomery q,qinv,poly1,tmp
 156 022c 13FB1BFC 	>>  smulbt tmp,poly1,qinv
 156 0230 1BFB0C3C 	>>  smlabb tmp,q,tmp,poly1
 156 0234 CCEA2E43 	>  pkhtb poly1,tmp,tmp2,asr#16
 157              	
 158 0238 16EE90AA 	    vmov twiddle, s13
 159              	    mul_twiddle b, poly2, twiddle, tmp, tmp2, q, qinv
 159 023c 14FB0AFC 	>  smulbb tmp,poly2,twiddle
 159 0240 14FB2AF4 	>  smultb poly2,poly2,twiddle
 159              	>  montgomery q,qinv,tmp,tmp2
 159 0244 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 159 0248 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 159              	>  montgomery q,qinv,poly2,tmp
 159 024c 14FB1BFC 	>>  smulbt tmp,poly2,qinv
 159 0250 1BFB0C4C 	>>  smlabb tmp,q,tmp,poly2
 159 0254 CCEA2E44 	>  pkhtb poly2,tmp,tmp2,asr#16
 160              	    mul_twiddle t, poly3, twiddle, tmp, tmp2, q, qinv
 160 0258 15FB1AFC 	>  smulbt tmp,poly3,twiddle
 160 025c 15FB3AF5 	>  smultt poly3,poly3,twiddle
 160              	>  montgomery q,qinv,tmp,tmp2
 160 0260 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 160 0264 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 160              	>  montgomery q,qinv,poly3,tmp
 160 0268 15FB1BFC 	>>  smulbt tmp,poly3,qinv
 160 026c 1BFB0C5C 	>>  smlabb tmp,q,tmp,poly3
 160 0270 CCEA2E45 	>  pkhtb poly3,tmp,tmp2,asr#16
 161              	
 162 0274 17EE10AA 	    vmov twiddle, s14
 163              	    mul_twiddle b, poly4, twiddle, tmp, tmp2, q, qinv
 163 0278 16FB0AFC 	>  smulbb tmp,poly4,twiddle
 163 027c 16FB2AF6 	>  smultb poly4,poly4,twiddle
 163              	>  montgomery q,qinv,tmp,tmp2
 163 0280 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 163 0284 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 163              	>  montgomery q,qinv,poly4,tmp
 163 0288 16FB1BFC 	>>  smulbt tmp,poly4,qinv
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 11


 163 028c 1BFB0C6C 	>>  smlabb tmp,q,tmp,poly4
 163 0290 CCEA2E46 	>  pkhtb poly4,tmp,tmp2,asr#16
 164              	    mul_twiddle t, poly5, twiddle, tmp, tmp2, q, qinv
 164 0294 17FB1AFC 	>  smulbt tmp,poly5,twiddle
 164 0298 17FB3AF7 	>  smultt poly5,poly5,twiddle
 164              	>  montgomery q,qinv,tmp,tmp2
 164 029c 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 164 02a0 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 164              	>  montgomery q,qinv,poly5,tmp
 164 02a4 17FB1BFC 	>>  smulbt tmp,poly5,qinv
 164 02a8 1BFB0C7C 	>>  smlabb tmp,q,tmp,poly5
 164 02ac CCEA2E47 	>  pkhtb poly5,tmp,tmp2,asr#16
 165              	
 166 02b0 17EE90AA 	    vmov twiddle, s15
 167              	    mul_twiddle b, poly6, twiddle, tmp, tmp2, q, qinv
 167 02b4 18FB0AFC 	>  smulbb tmp,poly6,twiddle
 167 02b8 18FB2AF8 	>  smultb poly6,poly6,twiddle
 167              	>  montgomery q,qinv,tmp,tmp2
 167 02bc 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 167 02c0 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 167              	>  montgomery q,qinv,poly6,tmp
 167 02c4 18FB1BFC 	>>  smulbt tmp,poly6,qinv
 167 02c8 1BFB0C8C 	>>  smlabb tmp,q,tmp,poly6
 167 02cc CCEA2E48 	>  pkhtb poly6,tmp,tmp2,asr#16
 168              	    mul_twiddle t, poly7, twiddle, tmp, tmp2, q, qinv
 168 02d0 19FB1AFC 	>  smulbt tmp,poly7,twiddle
 168 02d4 19FB3AF9 	>  smultt poly7,poly7,twiddle
 168              	>  montgomery q,qinv,tmp,tmp2
 168 02d8 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 168 02dc 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 168              	>  montgomery q,qinv,poly7,tmp
 168 02e0 19FB1BFC 	>>  smulbt tmp,poly7,qinv
 168 02e4 1BFB0C9C 	>>  smlabb tmp,q,tmp,poly7
 168 02e8 CCEA2E49 	>  pkhtb poly7,tmp,tmp2,asr#16
 169              	
 170 02ec 00EE102A 	    vmov s0, poly0 // a1
 171 02f0 00EE903A 	    vmov s1, poly1 // a3
 172 02f4 01EE104A 	    vmov s2, poly2 // a5
 173 02f8 01EE905A 	    vmov s3, poly3 // a7
 174 02fc 02EE106A 	    vmov s4, poly4 // a9
 175 0300 02EE907A 	    vmov s5, poly5 // a11
 176 0304 03EE108A 	    vmov s6, poly6 // a13
 177 0308 03EE909A 	    vmov s7, poly7 // a15
 178              	
 179              	    // ----------
 180              	
 181              	    // load a0, a2, ..., a14
 182              	    load poly, poly0, poly1, poly2, poly3, #0, #distance/4, #2*distance/4, #3*distance/4
 182 030c D0F80020 	>  ldr.w poly0,[poly,#0]
 182 0310 D0F84030 	>  ldr.w poly1,[poly,#distance/4]
 182 0314 D0F88040 	>  ldr.w poly2,[poly,#2*distance/4]
 182 0318 D0F8C050 	>  ldr.w poly3,[poly,#3*distance/4]
 183              	    load poly, poly4, poly5, poly6, poly7, #distance, #5*distance/4, #6*distance/4, #7*distance/4
 183 031c D0F80061 	>  ldr.w poly4,[poly,#distance]
 183 0320 D0F84071 	>  ldr.w poly5,[poly,#5*distance/4]
 183 0324 D0F88081 	>  ldr.w poly6,[poly,#6*distance/4]
 183 0328 D0F8C091 	>  ldr.w poly7,[poly,#7*distance/4]
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 12


 184              	
 185              	    // 8-NTT on a0, a2, ..., a14
 186              	    _3_layer_double_CT_16_fp poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, s8, s9, s10, s
 186              	> 
 186 032c 14EE10AA 	>  vmov twiddle,s8
 186              	>  two_doublebutterfly t,t,poly0,poly4,poly1,poly5,twiddle,tmp,tmp2,q,qinv
 186              	>>  doublebutterfly t,poly0,poly4,twiddle,tmp,tmp2,q,qinv
 186 0330 16FB1AFC 	>>>  smulbt tmp,poly4,twiddle
 186 0334 16FB3AF6 	>>>  smultt poly4,poly4,twiddle
 186              	>>>  montgomery q,qinv,tmp,tmp2
 186 0338 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 186 033c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 186              	>>>  montgomery q,qinv,poly4,tmp
 186 0340 16FB1BFC 	>>>>  smulbt tmp,poly4,qinv
 186 0344 1BFB0C6C 	>>>>  smlabb tmp,q,tmp,poly4
 186 0348 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 186 034c D2FA4EF6 	>>>  usub16 poly4,poly0,tmp2
 186 0350 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 186              	>>  doublebutterfly t,poly1,poly5,twiddle,tmp,tmp2,q,qinv
 186 0354 17FB1AFC 	>>>  smulbt tmp,poly5,twiddle
 186 0358 17FB3AF7 	>>>  smultt poly5,poly5,twiddle
 186              	>>>  montgomery q,qinv,tmp,tmp2
 186 035c 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 186 0360 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 186              	>>>  montgomery q,qinv,poly5,tmp
 186 0364 17FB1BFC 	>>>>  smulbt tmp,poly5,qinv
 186 0368 1BFB0C7C 	>>>>  smlabb tmp,q,tmp,poly5
 186 036c CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 186 0370 D3FA4EF7 	>>>  usub16 poly5,poly1,tmp2
 186 0374 93FA4EF3 	>>>  uadd16 poly1,poly1,tmp2
 186              	>  two_doublebutterfly t,t,poly2,poly6,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 186              	>>  doublebutterfly t,poly2,poly6,twiddle,tmp,tmp2,q,qinv
 186 0378 18FB1AFC 	>>>  smulbt tmp,poly6,twiddle
 186 037c 18FB3AF8 	>>>  smultt poly6,poly6,twiddle
 186              	>>>  montgomery q,qinv,tmp,tmp2
 186 0380 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 186 0384 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 186              	>>>  montgomery q,qinv,poly6,tmp
 186 0388 18FB1BFC 	>>>>  smulbt tmp,poly6,qinv
 186 038c 1BFB0C8C 	>>>>  smlabb tmp,q,tmp,poly6
 186 0390 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 186 0394 D4FA4EF8 	>>>  usub16 poly6,poly2,tmp2
 186 0398 94FA4EF4 	>>>  uadd16 poly2,poly2,tmp2
 186              	>>  doublebutterfly t,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 186 039c 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 186 03a0 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 186              	>>>  montgomery q,qinv,tmp,tmp2
 186 03a4 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 186 03a8 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 186              	>>>  montgomery q,qinv,poly7,tmp
 186 03ac 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 186 03b0 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 186 03b4 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 186 03b8 D5FA4EF9 	>>>  usub16 poly7,poly3,tmp2
 186 03bc 95FA4EF5 	>>>  uadd16 poly3,poly3,tmp2
 186              	> 
 186              	> 
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 13


 186 03c0 14EE90AA 	>  vmov twiddle,s9
 186              	>  two_doublebutterfly b,b,poly0,poly2,poly1,poly3,twiddle,tmp,tmp2,q,qinv
 186              	>>  doublebutterfly b,poly0,poly2,twiddle,tmp,tmp2,q,qinv
 186 03c4 14FB0AFC 	>>>  smulbb tmp,poly2,twiddle
 186 03c8 14FB2AF4 	>>>  smultb poly2,poly2,twiddle
 186              	>>>  montgomery q,qinv,tmp,tmp2
 186 03cc 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 186 03d0 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 186              	>>>  montgomery q,qinv,poly2,tmp
 186 03d4 14FB1BFC 	>>>>  smulbt tmp,poly2,qinv
 186 03d8 1BFB0C4C 	>>>>  smlabb tmp,q,tmp,poly2
 186 03dc CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 186 03e0 D2FA4EF4 	>>>  usub16 poly2,poly0,tmp2
 186 03e4 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 186              	>>  doublebutterfly b,poly1,poly3,twiddle,tmp,tmp2,q,qinv
 186 03e8 15FB0AFC 	>>>  smulbb tmp,poly3,twiddle
 186 03ec 15FB2AF5 	>>>  smultb poly3,poly3,twiddle
 186              	>>>  montgomery q,qinv,tmp,tmp2
 186 03f0 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 186 03f4 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 186              	>>>  montgomery q,qinv,poly3,tmp
 186 03f8 15FB1BFC 	>>>>  smulbt tmp,poly3,qinv
 186 03fc 1BFB0C5C 	>>>>  smlabb tmp,q,tmp,poly3
 186 0400 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 186 0404 D3FA4EF5 	>>>  usub16 poly3,poly1,tmp2
 186 0408 93FA4EF3 	>>>  uadd16 poly1,poly1,tmp2
 186              	> 
 186              	>  two_doublebutterfly t,t,poly4,poly6,poly5,poly7,twiddle,tmp,tmp2,q,qinv
 186              	>>  doublebutterfly t,poly4,poly6,twiddle,tmp,tmp2,q,qinv
 186 040c 18FB1AFC 	>>>  smulbt tmp,poly6,twiddle
 186 0410 18FB3AF8 	>>>  smultt poly6,poly6,twiddle
 186              	>>>  montgomery q,qinv,tmp,tmp2
 186 0414 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 186 0418 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 186              	>>>  montgomery q,qinv,poly6,tmp
 186 041c 18FB1BFC 	>>>>  smulbt tmp,poly6,qinv
 186 0420 1BFB0C8C 	>>>>  smlabb tmp,q,tmp,poly6
 186 0424 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 186 0428 D6FA4EF8 	>>>  usub16 poly6,poly4,tmp2
 186 042c 96FA4EF6 	>>>  uadd16 poly4,poly4,tmp2
 186              	>>  doublebutterfly t,poly5,poly7,twiddle,tmp,tmp2,q,qinv
 186 0430 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 186 0434 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 186              	>>>  montgomery q,qinv,tmp,tmp2
 186 0438 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 186 043c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 186              	>>>  montgomery q,qinv,poly7,tmp
 186 0440 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 186 0444 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 186 0448 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 186 044c D7FA4EF9 	>>>  usub16 poly7,poly5,tmp2
 186 0450 97FA4EF7 	>>>  uadd16 poly5,poly5,tmp2
 186              	> 
 186              	> 
 186 0454 15EE10AA 	>  vmov twiddle,s10
 186              	>  two_doublebutterfly b,t,poly0,poly1,poly2,poly3,twiddle,tmp,tmp2,q,qinv
 186              	>>  doublebutterfly b,poly0,poly1,twiddle,tmp,tmp2,q,qinv
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 14


 186 0458 13FB0AFC 	>>>  smulbb tmp,poly1,twiddle
 186 045c 13FB2AF3 	>>>  smultb poly1,poly1,twiddle
 186              	>>>  montgomery q,qinv,tmp,tmp2
 186 0460 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 186 0464 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 186              	>>>  montgomery q,qinv,poly1,tmp
 186 0468 13FB1BFC 	>>>>  smulbt tmp,poly1,qinv
 186 046c 1BFB0C3C 	>>>>  smlabb tmp,q,tmp,poly1
 186 0470 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 186 0474 D2FA4EF3 	>>>  usub16 poly1,poly0,tmp2
 186 0478 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 186              	>>  doublebutterfly t,poly2,poly3,twiddle,tmp,tmp2,q,qinv
 186 047c 15FB1AFC 	>>>  smulbt tmp,poly3,twiddle
 186 0480 15FB3AF5 	>>>  smultt poly3,poly3,twiddle
 186              	>>>  montgomery q,qinv,tmp,tmp2
 186 0484 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 186 0488 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 186              	>>>  montgomery q,qinv,poly3,tmp
 186 048c 15FB1BFC 	>>>>  smulbt tmp,poly3,qinv
 186 0490 1BFB0C5C 	>>>>  smlabb tmp,q,tmp,poly3
 186 0494 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 186 0498 D4FA4EF5 	>>>  usub16 poly3,poly2,tmp2
 186 049c 94FA4EF4 	>>>  uadd16 poly2,poly2,tmp2
 186              	> 
 186 04a0 15EE90AA 	>  vmov twiddle,s11
 186              	>  two_doublebutterfly b,t,poly4,poly5,poly6,poly7,twiddle,tmp,tmp2,q,qinv
 186              	>>  doublebutterfly b,poly4,poly5,twiddle,tmp,tmp2,q,qinv
 186 04a4 17FB0AFC 	>>>  smulbb tmp,poly5,twiddle
 186 04a8 17FB2AF7 	>>>  smultb poly5,poly5,twiddle
 186              	>>>  montgomery q,qinv,tmp,tmp2
 186 04ac 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 186 04b0 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 186              	>>>  montgomery q,qinv,poly5,tmp
 186 04b4 17FB1BFC 	>>>>  smulbt tmp,poly5,qinv
 186 04b8 1BFB0C7C 	>>>>  smlabb tmp,q,tmp,poly5
 186 04bc CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 186 04c0 D6FA4EF7 	>>>  usub16 poly5,poly4,tmp2
 186 04c4 96FA4EF6 	>>>  uadd16 poly4,poly4,tmp2
 186              	>>  doublebutterfly t,poly6,poly7,twiddle,tmp,tmp2,q,qinv
 186 04c8 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 186 04cc 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 186              	>>>  montgomery q,qinv,tmp,tmp2
 186 04d0 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 186 04d4 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 186              	>>>  montgomery q,qinv,poly7,tmp
 186 04d8 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 186 04dc 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 186 04e0 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 186 04e4 D8FA4EF9 	>>>  usub16 poly7,poly6,tmp2
 186 04e8 98FA4EF8 	>>>  uadd16 poly6,poly6,tmp2
 187              	
 188              	    // layer 4 - 1
 189              	    // addsub: (a2, a6, a10, a14), (a3, a7, a11, a15)
 190 04ec 10EE90EA 	    vmov tmp2, s1 // load a3
 191 04f0 00EE902A 	    vmov s1, poly0 // preserve a0
 192 04f4 93FA4EF2 	    uadd16 poly0, poly1, tmp2
 193 04f8 D3FA4EF3 	    usub16 poly1, poly1, tmp2
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 15


 194              	
 195 04fc 11EE90EA 	    vmov tmp2, s3 // load a7
 196 0500 01EE904A 	    vmov s3, poly2 // preserve a4
 197 0504 95FA4EF4 	    uadd16 poly2, poly3, tmp2
 198 0508 D5FA4EF5 	    usub16 poly3, poly3, tmp2
 199              	
 200 050c 12EE90EA 	    vmov tmp2, s5 // load a11
 201 0510 02EE906A 	    vmov s5, poly4 // preserve a8
 202 0514 97FA4EF6 	    uadd16 poly4, poly5, tmp2
 203 0518 D7FA4EF7 	    usub16 poly5, poly5, tmp2
 204              	
 205 051c 13EE90EA 	    vmov tmp2, s7 // load a15
 206 0520 03EE908A 	    vmov s7, poly6 // preserve a12
 207 0524 99FA4EF8 	    uadd16 poly6, poly7, tmp2
 208 0528 D9FA4EF9 	    usub16 poly7, poly7, tmp2
 209              	
 210 052c C0F84020 	    str.w poly0, [poly, #1*distance/4]
 211 0530 C0F86030 	    str.w poly1, [poly, #1*distance/4+offset]
 212 0534 C0F8C040 	    str.w poly2, [poly, #3*distance/4]
 213 0538 C0F8E050 	    str.w poly3, [poly, #3*distance/4+offset]
 214 053c C0F84061 	    str.w poly4, [poly, #5*distance/4]
 215 0540 C0F86071 	    str.w poly5, [poly, #5*distance/4+offset]
 216 0544 C0F8C081 	    str.w poly6, [poly, #7*distance/4]
 217 0548 C0F8E091 	    str.w poly7, [poly, #7*distance/4+offset]
 218              	
 219              	    // layer 4 - 2
 220              	    // addsub: (a0, a4, a8, a12), (a1, a5, a9, a13)
 221 054c 10EE90EA 	    vmov tmp2, s1 // load a0
 222 0550 10EE103A 	    vmov poly1, s0 // load a1
 223 0554 9EFA43F2 	    uadd16 poly0, tmp2, poly1
 224 0558 DEFA43F3 	    usub16 poly1, tmp2, poly1
 225              	
 226 055c 11EE90EA 	    vmov tmp2, s3 // load a4
 227 0560 11EE105A 	    vmov poly3, s2 // load a5
 228 0564 9EFA45F4 	    uadd16 poly2, tmp2, poly3
 229 0568 DEFA45F5 	    usub16 poly3, tmp2, poly3
 230              	
 231 056c 12EE90EA 	    vmov tmp2, s5 // load a8
 232 0570 12EE107A 	    vmov poly5, s4 // load a9
 233 0574 9EFA47F6 	    uadd16 poly4, tmp2, poly5
 234 0578 DEFA47F7 	    usub16 poly5, tmp2, poly5
 235              	
 236 057c 13EE90EA 	    vmov tmp2, s7 // load a12
 237 0580 13EE109A 	    vmov poly7, s6 // load a13
 238 0584 9EFA49F8 	    uadd16 poly6, tmp2, poly7
 239 0588 DEFA49F9 	    usub16 poly7, tmp2, poly7
 240              	
 241 058c C0F82030 	    str.w poly1, [poly, #offset]
 242 0590 C0F88040 	    str.w poly2, [poly, #2*distance/4]
 243 0594 C0F8A050 	    str.w poly3, [poly, #2*distance/4+offset]
 244 0598 C0F80061 	    str.w poly4, [poly, #4*distance/4]
 245 059c C0F82071 	    str.w poly5, [poly, #4*distance/4+offset]
 246 05a0 C0F88081 	    str.w poly6, [poly, #6*distance/4]
 247 05a4 C0F8A091 	    str.w poly7, [poly, #6*distance/4+offset]
 248 05a8 40F8042B 	    str.w poly0, [poly], #4
 249              	
 250 05ac 18EE10CA 	    vmov tmp, s16
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 16


 251 05b0 B0EB0C0F 	    cmp.w poly, tmp
 252 05b4 7FF432AD 	  bne.w 1b
 253              	
 254 05b8 A0F12000 	  sub.w poly, #8*strincr
 255              	
 256              	  ### LAYER 3+2+1
 257              	
 258              	  .equ distance, distance/16
 259              	  .equ strincr, 32
 260              	
 261 05bc 00F5007C 	  add.w tmp, poly, #strincr*16
 262 05c0 06EE90CA 	  vmov s13, tmp
 263              	
 264              	  2:
 265              	    load poly, poly0, poly1, poly2, poly3, #0, #distance/4, #2*distance/4, #3*distance/4
 265 05c4 D0F80020 	>  ldr.w poly0,[poly,#0]
 265 05c8 D0F80430 	>  ldr.w poly1,[poly,#distance/4]
 265 05cc D0F80840 	>  ldr.w poly2,[poly,#2*distance/4]
 265 05d0 D0F80C50 	>  ldr.w poly3,[poly,#3*distance/4]
 266              	    load poly, poly4, poly5, poly6, poly7, #distance, #5*distance/4, #6*distance/4, #7*distance/4
 266 05d4 D0F81060 	>  ldr.w poly4,[poly,#distance]
 266 05d8 D0F81470 	>  ldr.w poly5,[poly,#5*distance/4]
 266 05dc D0F81880 	>  ldr.w poly6,[poly,#6*distance/4]
 266 05e0 D0F81C90 	>  ldr.w poly7,[poly,#7*distance/4]
 267              	
 268              	    _3_layer_double_CT_16 poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, twiddle, twiddle_
 268              	> 
 268 05e4 31F802AB 	>  ldrh.w twiddle,[twiddle_ptr],#2
 268              	>  two_doublebutterfly b,b,poly0,poly4,poly1,poly5,twiddle,tmp,tmp2,q,qinv
 268              	>>  doublebutterfly b,poly0,poly4,twiddle,tmp,tmp2,q,qinv
 268 05e8 16FB0AFC 	>>>  smulbb tmp,poly4,twiddle
 268 05ec 16FB2AF6 	>>>  smultb poly4,poly4,twiddle
 268              	>>>  montgomery q,qinv,tmp,tmp2
 268 05f0 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 268 05f4 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 268              	>>>  montgomery q,qinv,poly4,tmp
 268 05f8 16FB1BFC 	>>>>  smulbt tmp,poly4,qinv
 268 05fc 1BFB0C6C 	>>>>  smlabb tmp,q,tmp,poly4
 268 0600 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 268 0604 D2FA4EF6 	>>>  usub16 poly4,poly0,tmp2
 268 0608 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 268              	>>  doublebutterfly b,poly1,poly5,twiddle,tmp,tmp2,q,qinv
 268 060c 17FB0AFC 	>>>  smulbb tmp,poly5,twiddle
 268 0610 17FB2AF7 	>>>  smultb poly5,poly5,twiddle
 268              	>>>  montgomery q,qinv,tmp,tmp2
 268 0614 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 268 0618 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 268              	>>>  montgomery q,qinv,poly5,tmp
 268 061c 17FB1BFC 	>>>>  smulbt tmp,poly5,qinv
 268 0620 1BFB0C7C 	>>>>  smlabb tmp,q,tmp,poly5
 268 0624 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 268 0628 D3FA4EF7 	>>>  usub16 poly5,poly1,tmp2
 268 062c 93FA4EF3 	>>>  uadd16 poly1,poly1,tmp2
 268              	>  two_doublebutterfly b,b,poly2,poly6,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 268              	>>  doublebutterfly b,poly2,poly6,twiddle,tmp,tmp2,q,qinv
 268 0630 18FB0AFC 	>>>  smulbb tmp,poly6,twiddle
 268 0634 18FB2AF8 	>>>  smultb poly6,poly6,twiddle
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 17


 268              	>>>  montgomery q,qinv,tmp,tmp2
 268 0638 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 268 063c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 268              	>>>  montgomery q,qinv,poly6,tmp
 268 0640 18FB1BFC 	>>>>  smulbt tmp,poly6,qinv
 268 0644 1BFB0C8C 	>>>>  smlabb tmp,q,tmp,poly6
 268 0648 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 268 064c D4FA4EF8 	>>>  usub16 poly6,poly2,tmp2
 268 0650 94FA4EF4 	>>>  uadd16 poly2,poly2,tmp2
 268              	>>  doublebutterfly b,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 268 0654 19FB0AFC 	>>>  smulbb tmp,poly7,twiddle
 268 0658 19FB2AF9 	>>>  smultb poly7,poly7,twiddle
 268              	>>>  montgomery q,qinv,tmp,tmp2
 268 065c 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 268 0660 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 268              	>>>  montgomery q,qinv,poly7,tmp
 268 0664 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 268 0668 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 268 066c CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 268 0670 D5FA4EF9 	>>>  usub16 poly7,poly3,tmp2
 268 0674 95FA4EF5 	>>>  uadd16 poly3,poly3,tmp2
 268              	> 
 268              	> 
 268 0678 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 268              	>  two_doublebutterfly b,b,poly0,poly2,poly1,poly3,twiddle,tmp,tmp2,q,qinv
 268              	>>  doublebutterfly b,poly0,poly2,twiddle,tmp,tmp2,q,qinv
 268 067c 14FB0AFC 	>>>  smulbb tmp,poly2,twiddle
 268 0680 14FB2AF4 	>>>  smultb poly2,poly2,twiddle
 268              	>>>  montgomery q,qinv,tmp,tmp2
 268 0684 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 268 0688 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 268              	>>>  montgomery q,qinv,poly2,tmp
 268 068c 14FB1BFC 	>>>>  smulbt tmp,poly2,qinv
 268 0690 1BFB0C4C 	>>>>  smlabb tmp,q,tmp,poly2
 268 0694 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 268 0698 D2FA4EF4 	>>>  usub16 poly2,poly0,tmp2
 268 069c 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 268              	>>  doublebutterfly b,poly1,poly3,twiddle,tmp,tmp2,q,qinv
 268 06a0 15FB0AFC 	>>>  smulbb tmp,poly3,twiddle
 268 06a4 15FB2AF5 	>>>  smultb poly3,poly3,twiddle
 268              	>>>  montgomery q,qinv,tmp,tmp2
 268 06a8 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 268 06ac 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 268              	>>>  montgomery q,qinv,poly3,tmp
 268 06b0 15FB1BFC 	>>>>  smulbt tmp,poly3,qinv
 268 06b4 1BFB0C5C 	>>>>  smlabb tmp,q,tmp,poly3
 268 06b8 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 268 06bc D3FA4EF5 	>>>  usub16 poly3,poly1,tmp2
 268 06c0 93FA4EF3 	>>>  uadd16 poly1,poly1,tmp2
 268              	> 
 268              	>  two_doublebutterfly t,t,poly4,poly6,poly5,poly7,twiddle,tmp,tmp2,q,qinv
 268              	>>  doublebutterfly t,poly4,poly6,twiddle,tmp,tmp2,q,qinv
 268 06c4 18FB1AFC 	>>>  smulbt tmp,poly6,twiddle
 268 06c8 18FB3AF8 	>>>  smultt poly6,poly6,twiddle
 268              	>>>  montgomery q,qinv,tmp,tmp2
 268 06cc 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 268 06d0 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 18


 268              	>>>  montgomery q,qinv,poly6,tmp
 268 06d4 18FB1BFC 	>>>>  smulbt tmp,poly6,qinv
 268 06d8 1BFB0C8C 	>>>>  smlabb tmp,q,tmp,poly6
 268 06dc CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 268 06e0 D6FA4EF8 	>>>  usub16 poly6,poly4,tmp2
 268 06e4 96FA4EF6 	>>>  uadd16 poly4,poly4,tmp2
 268              	>>  doublebutterfly t,poly5,poly7,twiddle,tmp,tmp2,q,qinv
 268 06e8 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 268 06ec 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 268              	>>>  montgomery q,qinv,tmp,tmp2
 268 06f0 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 268 06f4 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 268              	>>>  montgomery q,qinv,poly7,tmp
 268 06f8 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 268 06fc 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 268 0700 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 268 0704 D7FA4EF9 	>>>  usub16 poly7,poly5,tmp2
 268 0708 97FA4EF7 	>>>  uadd16 poly5,poly5,tmp2
 268              	> 
 268              	> 
 268 070c 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 268              	>  two_doublebutterfly b,t,poly0,poly1,poly2,poly3,twiddle,tmp,tmp2,q,qinv
 268              	>>  doublebutterfly b,poly0,poly1,twiddle,tmp,tmp2,q,qinv
 268 0710 13FB0AFC 	>>>  smulbb tmp,poly1,twiddle
 268 0714 13FB2AF3 	>>>  smultb poly1,poly1,twiddle
 268              	>>>  montgomery q,qinv,tmp,tmp2
 268 0718 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 268 071c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 268              	>>>  montgomery q,qinv,poly1,tmp
 268 0720 13FB1BFC 	>>>>  smulbt tmp,poly1,qinv
 268 0724 1BFB0C3C 	>>>>  smlabb tmp,q,tmp,poly1
 268 0728 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 268 072c D2FA4EF3 	>>>  usub16 poly1,poly0,tmp2
 268 0730 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 268              	>>  doublebutterfly t,poly2,poly3,twiddle,tmp,tmp2,q,qinv
 268 0734 15FB1AFC 	>>>  smulbt tmp,poly3,twiddle
 268 0738 15FB3AF5 	>>>  smultt poly3,poly3,twiddle
 268              	>>>  montgomery q,qinv,tmp,tmp2
 268 073c 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 268 0740 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 268              	>>>  montgomery q,qinv,poly3,tmp
 268 0744 15FB1BFC 	>>>>  smulbt tmp,poly3,qinv
 268 0748 1BFB0C5C 	>>>>  smlabb tmp,q,tmp,poly3
 268 074c CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 268 0750 D4FA4EF5 	>>>  usub16 poly3,poly2,tmp2
 268 0754 94FA4EF4 	>>>  uadd16 poly2,poly2,tmp2
 268              	> 
 268 0758 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 268              	>  two_doublebutterfly b,t,poly4,poly5,poly6,poly7,twiddle,tmp,tmp2,q,qinv
 268              	>>  doublebutterfly b,poly4,poly5,twiddle,tmp,tmp2,q,qinv
 268 075c 17FB0AFC 	>>>  smulbb tmp,poly5,twiddle
 268 0760 17FB2AF7 	>>>  smultb poly5,poly5,twiddle
 268              	>>>  montgomery q,qinv,tmp,tmp2
 268 0764 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 268 0768 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 268              	>>>  montgomery q,qinv,poly5,tmp
 268 076c 17FB1BFC 	>>>>  smulbt tmp,poly5,qinv
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 19


 268 0770 1BFB0C7C 	>>>>  smlabb tmp,q,tmp,poly5
 268 0774 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 268 0778 D6FA4EF7 	>>>  usub16 poly5,poly4,tmp2
 268 077c 96FA4EF6 	>>>  uadd16 poly4,poly4,tmp2
 268              	>>  doublebutterfly t,poly6,poly7,twiddle,tmp,tmp2,q,qinv
 268 0780 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 268 0784 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 268              	>>>  montgomery q,qinv,tmp,tmp2
 268 0788 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 268 078c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 268              	>>>  montgomery q,qinv,poly7,tmp
 268 0790 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 268 0794 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 268 0798 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 268 079c D8FA4EF9 	>>>  usub16 poly7,poly6,tmp2
 268 07a0 98FA4EF8 	>>>  uadd16 poly6,poly6,tmp2
 269              	
 270              	    store poly, poly4, poly5, poly6, poly7, #distance, #5*distance/4, #6*distance/4, #7*distance/4
 270 07a4 C0F81060 	>  str.w poly4,[poly,#distance]
 270 07a8 C0F81470 	>  str.w poly5,[poly,#5*distance/4]
 270 07ac C0F81880 	>  str.w poly6,[poly,#6*distance/4]
 270 07b0 C0F81C90 	>  str.w poly7,[poly,#7*distance/4]
 271 07b4 C0F80430 	    str.w poly1, [poly, #distance/4]
 272 07b8 C0F80840 	    str.w poly2, [poly, #2*distance/4]
 273 07bc C0F80C50 	    str.w poly3, [poly, #3*distance/4]
 274 07c0 40F8202B 	    str.w poly0, [poly], #strincr
 275              	
 276 07c4 16EE90CA 	    vmov tmp, s13
 277 07c8 B0EB0C0F 	    cmp.w poly, tmp
 278 07cc 7FF4FAAE 	  bne.w 2b
 279              	
 280 07d0 BDEC018A 	  vpop.w {s16}
 281 07d4 BDE8F08F 	  pop {r4-r11, pc}
 282              	
 283              	
 284              	.unreq poly
 285              	.unreq twiddle_ptr
 286              	.unreq poly0
 287              	.unreq poly1
 288              	.unreq poly2
 289              	.unreq poly3
 290              	.unreq poly4
 291              	.unreq poly5
 292              	.unreq poly6
 293              	.unreq poly7
 294              	.unreq twiddle
 295              	.unreq qinv
 296              	.unreq q
 297              	.unreq tmp
 298              	.unreq tmp2
 299              	
 300              	// ########
 301              	// ########
 302              	// # INTT #
 303              	// ########
 304              	// ########
 305              	
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 20


 306              	.macro doublebutterfly_light a0, a1, tmp, tmp2, q, qinv
 307              	  uadd16 \tmp, \a0, \a1
 308              	  usub16 \a1, \a0, \a1
 309              	  mov.w \a0, \tmp
 310              	.endm
 311              	
 312              	.macro two_doublebutterfly_light a0, a1, a2, a3, tmp, tmp2, q, qinv
 313              	  doublebutterfly_light \a0, \a1, \tmp, \tmp2, \q, \qinv
 314              	  doublebutterfly_light \a2, \a3, \tmp, \tmp2, \q, \qinv
 315              	.endm
 316              	
 317              	.macro _3_layer_double_inv_CT_16_light c0, c1, c2, c3, c4, c5, c6, c7, xi0, xi12, xi34, xi56, twidd
 318              	
 319              	  // layer 1
 320              	  sadd16.w \tmp, \c0, \c1 // c0, c1
 321              	  ssub16.w \c1, \c0, \c1
 322              	  sadd16.w \tmp2, \c2, \c3 // c2, c3
 323              	  ssub16.w \c3, \c2, \c3
 324              	
 325              	  sadd16.w \c0, \c4, \c5 // c4, c5
 326              	  ssub16.w \c5, \c4, \c5
 327              	  sadd16.w \c2, \c6, \c7 // c6, c7
 328              	  ssub16.w \c7, \c6, \c7
 329              	  // c4, c6 are free at this point
 330              	
 331              	  // layer 2
 332              	  sadd16.w \c6, \tmp, \tmp2 // c0, c2
 333              	  ssub16.w \tmp2, \tmp, \tmp2
 334              	  sadd16.w \c4, \c0, \c2 // c4, c6
 335              	  ssub16.w \c2, \c0, \c2
 336              	
 337              	  vmov.w \twiddle, \xi12
 338              	  doublebutterfly t, \c1, \c3, \twiddle, \tmp, \c0, \q, \qinv // c0 has been used and c6 still free
 339              	  doublebutterfly t, \c5, \c7, \twiddle, \tmp, \c0, \q, \qinv
 340              	  // c0, c6 are free at this point
 341              	
 342              	  // layer 3
 343              	  sadd16.w \c0, \c6, \c4 // c0, c4
 344              	  ssub16.w \c4, \c6, \c4
 345              	
 346              	  vmov.w \twiddle, \xi34
 347              	  doublebutterfly t, \c1, \c5, \twiddle, \tmp, \c6, \q, \qinv
 348              	
 349              	  vmov.w \twiddle, \xi56
 350              	  // this block is one doublebutterfly
 351              	  smulbb \tmp, \c2, \twiddle // c2, c6
 352              	  smultb \c2, \c2, \twiddle
 353              	  montgomery_inplace \q, \qinv, \tmp, \c6
 354              	  montgomery_inplace \q, \qinv, \c2, \c6
 355              	  pkhtb \tmp, \c2, \tmp, asr #16
 356              	  ssub16.w \c6, \tmp2, \tmp
 357              	  sadd16.w \c2, \tmp2, \tmp
 358              	
 359              	  doublebutterfly t, \c3, \c7, \twiddle, \tmp, \tmp2, \q, \qinv
 360              	
 361              	.endm
 362              	
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 21


 363              	.macro _3_layer_double_inv_CT_16_light_reduce c0, c1, c2, c3, c4, c5, c6, c7, xi0, xi12, xi34, xi56
 364              	
 365              	  // layer 1
 366              	  sadd16.w \tmp, \c0, \c1 // c0, c1
 367              	  ssub16.w \c1, \c0, \c1
 368              	  sadd16.w \tmp2, \c2, \c3 // c2, c3
 369              	  ssub16.w \c3, \c2, \c3
 370              	
 371              	  sadd16.w \c0, \c4, \c5 // c4, c5
 372              	  ssub16.w \c5, \c4, \c5
 373              	  sadd16.w \c2, \c6, \c7 // c6, c7
 374              	  ssub16.w \c7, \c6, \c7
 375              	  // c4, c6 are free at this point
 376              	
 377              	  mov.w \c6, \tmp
 378              	  mov.w \c4, \c0
 379              	
 380              	  // layer 2
 381              	  vmov.w \twiddle, \xi12
 382              	  doublebutterfly b, \c6, \tmp2, \twiddle, \tmp, \c0, \q, \qinv
 383              	  doublebutterfly b, \c4, \c2, \twiddle, \tmp, \c0, \q, \qinv
 384              	  doublebutterfly t, \c1, \c3, \twiddle, \tmp, \c0, \q, \qinv // c0 has been used and c6 still free
 385              	  doublebutterfly t, \c5, \c7, \twiddle, \tmp, \c0, \q, \qinv
 386              	  // c0, c6 are free at this point
 387              	
 388              	  // layer 3
 389              	  sadd16.w \c0, \c6, \c4 // c0, c4
 390              	  ssub16.w \c4, \c6, \c4
 391              	
 392              	  vmov.w \twiddle, \xi34
 393              	  doublebutterfly t, \c1, \c5, \twiddle, \tmp, \c6, \q, \qinv
 394              	
 395              	  vmov.w \twiddle, \xi56
 396              	  // this block is one doublebutterfly
 397              	  smulbb \tmp, \c2, \twiddle // c2, c6
 398              	  smultb \c2, \c2, \twiddle
 399              	  montgomery_inplace \q, \qinv, \tmp, \c6
 400              	  montgomery_inplace \q, \qinv, \c2, \c6
 401              	  pkhtb \tmp, \c2, \tmp, asr #16
 402              	  ssub16.w \c6, \tmp2, \tmp
 403              	  sadd16.w \c2, \tmp2, \tmp
 404              	
 405              	  doublebutterfly t, \c3, \c7, \twiddle, \tmp, \tmp2, \q, \qinv
 406              	
 407              	.endm
 408              	
 409              	.macro _3_layer_double_inv_CT_16 c0, c1, c2, c3, c4, c5, c6, c7, twiddle, twiddle_ptr, Qprime, Q, t
 410              	    // layer 3
 411              	    ldrh.w twiddle, [twiddle_ptr], #2
 412              	    two_doublebutterfly b, b, \c0, \c1, \c2, \c3, \twiddle, \tmp, \tmp2, \Q, \Qprime
 413              	    two_doublebutterfly b, b, \c4, \c5, \c6, \c7, \twiddle, \tmp, \tmp2, \Q, \Qprime
 414              	
 415              	    // layer 2
 416              	    ldr.w twiddle, [twiddle_ptr], #4
 417              	    two_doublebutterfly b, t, \c0, \c2, \c1, \c3, \twiddle, \tmp, \tmp2, \Q, \Qprime
 418              	
 419              	    two_doublebutterfly b, t, \c4, \c6, \c5, \c7, \twiddle, \tmp, \tmp2, \Q, \Qprime
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 22


 420              	
 421              	    // layer 1
 422              	    ldr.w twiddle, [twiddle_ptr], #4
 423              	    two_doublebutterfly b, t, \c0, \c4, \c1, \c5, \twiddle, \tmp, \tmp2, \Q, \Qprime
 424              	
 425              	    ldr.w twiddle, [twiddle_ptr], #4
 426              	    two_doublebutterfly b, t, \c2, \c6, \c3, \c7, \twiddle, \tmp, \tmp2, \Q, \Qprime
 427              	.endm
 428              	
 429              	.macro mul_twiddle_barrett_32 tb a, twiddle, Qbar, Q, tmp, tmp2
 430              	    smulb\tb \tmp, \a, \twiddle
 431              	    smmulr.w \tmp2, \tmp, \Qbar
 432              	    mls.w \tmp, \tmp2, \Q, \tmp
 433              	    smult\tb \a, \a, \twiddle
 434              	    smmulr.w \tmp2, \a, \Qbar
 435              	    mls.w \a, \tmp2, \Q, \a
 436              	    pkhbt \a, \tmp, \a, lsl #16
 437              	.endm
 438              	
 439              	.macro _3_layer_double_inv_twist_16 c0, c1, c2, c3, c4, c5, c6, c7, twiddle, twiddle_ptr, Qbar, Q, 
 440              	
 441              	    movt \Q, #0
 442              	
 443              	    ldr.w \twiddle, [\twiddle_ptr], #4
 444              	
 445              	    mul_twiddle_barrett_32 b, \c0, \twiddle, \Qbar, \Q, \tmp, \tmp2
 446              	    mul_twiddle_barrett_32 t, \c1, \twiddle, \Qbar, \Q, \tmp, \tmp2
 447              	
 448              	    ldr.w \twiddle, [\twiddle_ptr], #4
 449              	
 450              	    mul_twiddle_barrett_32 b, \c2, \twiddle, \Qbar, \Q, \tmp, \tmp2
 451              	    mul_twiddle_barrett_32 t, \c3, \twiddle, \Qbar, \Q, \tmp, \tmp2
 452              	
 453              	    ldr.w \twiddle, [\twiddle_ptr], #4
 454              	
 455              	    mul_twiddle_barrett_32 b, \c4, \twiddle, \Qbar, \Q, \tmp, \tmp2
 456              	    mul_twiddle_barrett_32 t, \c5, \twiddle, \Qbar, \Q, \tmp, \tmp2
 457              	
 458              	    ldr.w \twiddle, [\twiddle_ptr], #4
 459              	
 460              	    mul_twiddle_barrett_32 b, \c6, \twiddle, \Qbar, \Q, \tmp, \tmp2
 461              	    mul_twiddle_barrett_32 t, \c7, \twiddle, \Qbar, \Q, \tmp, \tmp2
 462              	
 463              	    movt \Q, #767
 464              	
 465              	.endm
 466              	
 467              	.global small_invntt_tomont_asm
 468              	.type small_invntt_tomont_asm, %function
 469              	.align 2
 470              	small_invntt_tomont_asm:
 471 07d8 2DE9F04F 	  push {r4-r11, r14}
 472              	
 473              	  poly        .req r0
 474              	  twiddle_ptr .req r1
 475              	  poly0       .req r2
 476              	  poly1       .req r3
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 23


 477              	  poly2       .req r4
 478              	  poly3       .req r5
 479              	  poly4       .req r6
 480              	  poly5       .req r7
 481              	  poly6       .req r8
 482              	  poly7       .req r9
 483              	  twiddle     .req r10
 484              	  qinv        .req r11
 485              	  q           .req r11
 486              	  tmp         .req r12
 487              	  tmp2        .req r14
 488              	
 489 07dc 40F2013B 	  movw q, #769
 490 07e0 C0F2FF2B 	  movt qinv, #767
 491              	
 492              	  ### LAYER 7+6+5+4
 493              	  .equ distance, 16
 494              	  .equ offset, 32
 495              	  .equ strincr, 64
 496              	
 497              	  // pre-load twiddle factors to FPU registers
 498 07e4 B1EC084A 	  vldm twiddle_ptr!, {s8-s15}
 499              	
 500 07e8 00F5007C 	  add.w tmp, poly, #8*strincr
 501 07ec 04EE10CA 	  vmov s8, tmp
 502              	  1:
 503              	    // load a1, a3, ..., a15
 504              	    load poly, poly0, poly1, poly2, poly3, #offset, #distance/4+offset, #2*distance/4+offset, #3*di
 504 07f0 D0F82020 	>  ldr.w poly0,[poly,#offset]
 504 07f4 D0F82430 	>  ldr.w poly1,[poly,#distance/4+offset]
 504 07f8 D0F82840 	>  ldr.w poly2,[poly,#2*distance/4+offset]
 504 07fc D0F82C50 	>  ldr.w poly3,[poly,#3*distance/4+offset]
 505              	    load poly, poly4, poly5, poly6, poly7, #distance+offset, #5*distance/4+offset, #6*distance/4+of
 505 0800 D0F83060 	>  ldr.w poly4,[poly,#distance+offset]
 505 0804 D0F83470 	>  ldr.w poly5,[poly,#5*distance/4+offset]
 505 0808 D0F83880 	>  ldr.w poly6,[poly,#6*distance/4+offset]
 505 080c D0F83C90 	>  ldr.w poly7,[poly,#7*distance/4+offset]
 506              	
 507              	    // NTT on a1, a3, ..., a15
 508              	    _3_layer_double_inv_CT_16_light poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, s8, s9,
 508              	> 
 508              	> 
 508 0810 92FA03FC 	>  sadd16.w tmp,poly0,poly1
 508 0814 D2FA03F3 	>  ssub16.w poly1,poly0,poly1
 508 0818 94FA05FE 	>  sadd16.w tmp2,poly2,poly3
 508 081c D4FA05F5 	>  ssub16.w poly3,poly2,poly3
 508              	> 
 508 0820 96FA07F2 	>  sadd16.w poly0,poly4,poly5
 508 0824 D6FA07F7 	>  ssub16.w poly5,poly4,poly5
 508 0828 98FA09F4 	>  sadd16.w poly2,poly6,poly7
 508 082c D8FA09F9 	>  ssub16.w poly7,poly6,poly7
 508              	> 
 508              	> 
 508              	> 
 508 0830 9CFA0EF8 	>  sadd16.w poly6,tmp,tmp2
 508 0834 DCFA0EFE 	>  ssub16.w tmp2,tmp,tmp2
 508 0838 92FA04F6 	>  sadd16.w poly4,poly0,poly2
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 24


 508 083c D2FA04F4 	>  ssub16.w poly2,poly0,poly2
 508              	> 
 508 0840 14EE90AA 	>  vmov.w twiddle,s9
 508              	>  doublebutterfly t,poly1,poly3,twiddle,tmp,poly0,q,qinv
 508 0844 15FB1AFC 	>>  smulbt tmp,poly3,twiddle
 508 0848 15FB3AF5 	>>  smultt poly3,poly3,twiddle
 508              	>>  montgomery q,qinv,tmp,poly0
 508 084c 1CFB1BF2 	>>>  smulbt poly0,tmp,qinv
 508 0850 1BFB02C2 	>>>  smlabb poly0,q,poly0,tmp
 508              	>>  montgomery q,qinv,poly3,tmp
 508 0854 15FB1BFC 	>>>  smulbt tmp,poly3,qinv
 508 0858 1BFB0C5C 	>>>  smlabb tmp,q,tmp,poly3
 508 085c CCEA2242 	>>  pkhtb poly0,tmp,poly0,asr#16
 508 0860 D3FA42F5 	>>  usub16 poly3,poly1,poly0
 508 0864 93FA42F3 	>>  uadd16 poly1,poly1,poly0
 508              	>  doublebutterfly t,poly5,poly7,twiddle,tmp,poly0,q,qinv
 508 0868 19FB1AFC 	>>  smulbt tmp,poly7,twiddle
 508 086c 19FB3AF9 	>>  smultt poly7,poly7,twiddle
 508              	>>  montgomery q,qinv,tmp,poly0
 508 0870 1CFB1BF2 	>>>  smulbt poly0,tmp,qinv
 508 0874 1BFB02C2 	>>>  smlabb poly0,q,poly0,tmp
 508              	>>  montgomery q,qinv,poly7,tmp
 508 0878 19FB1BFC 	>>>  smulbt tmp,poly7,qinv
 508 087c 1BFB0C9C 	>>>  smlabb tmp,q,tmp,poly7
 508 0880 CCEA2242 	>>  pkhtb poly0,tmp,poly0,asr#16
 508 0884 D7FA42F9 	>>  usub16 poly7,poly5,poly0
 508 0888 97FA42F7 	>>  uadd16 poly5,poly5,poly0
 508              	> 
 508              	> 
 508              	> 
 508 088c 98FA06F2 	>  sadd16.w poly0,poly6,poly4
 508 0890 D8FA06F6 	>  ssub16.w poly4,poly6,poly4
 508              	> 
 508 0894 15EE10AA 	>  vmov.w twiddle,s10
 508              	>  doublebutterfly t,poly1,poly5,twiddle,tmp,poly6,q,qinv
 508 0898 17FB1AFC 	>>  smulbt tmp,poly5,twiddle
 508 089c 17FB3AF7 	>>  smultt poly5,poly5,twiddle
 508              	>>  montgomery q,qinv,tmp,poly6
 508 08a0 1CFB1BF8 	>>>  smulbt poly6,tmp,qinv
 508 08a4 1BFB08C8 	>>>  smlabb poly6,q,poly6,tmp
 508              	>>  montgomery q,qinv,poly5,tmp
 508 08a8 17FB1BFC 	>>>  smulbt tmp,poly5,qinv
 508 08ac 1BFB0C7C 	>>>  smlabb tmp,q,tmp,poly5
 508 08b0 CCEA2848 	>>  pkhtb poly6,tmp,poly6,asr#16
 508 08b4 D3FA48F7 	>>  usub16 poly5,poly1,poly6
 508 08b8 93FA48F3 	>>  uadd16 poly1,poly1,poly6
 508              	> 
 508 08bc 15EE90AA 	>  vmov.w twiddle,s11
 508              	> 
 508 08c0 14FB0AFC 	>  smulbb tmp,poly2,twiddle
 508 08c4 14FB2AF4 	>  smultb poly2,poly2,twiddle
 508              	>  montgomery_inplace q,qinv,tmp,poly6
 508 08c8 1CFB1BF8 	>>  smulbt poly6,tmp,qinv
 508 08cc 1BFB08CC 	>>  smlabb tmp,q,poly6,tmp
 508              	>  montgomery_inplace q,qinv,poly2,poly6
 508 08d0 14FB1BF8 	>>  smulbt poly6,poly2,qinv
 508 08d4 1BFB0844 	>>  smlabb poly2,q,poly6,poly2
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 25


 508 08d8 C4EA2C4C 	>  pkhtb tmp,poly2,tmp,asr#16
 508 08dc DEFA0CF8 	>  ssub16.w poly6,tmp2,tmp
 508 08e0 9EFA0CF4 	>  sadd16.w poly2,tmp2,tmp
 508              	> 
 508              	>  doublebutterfly t,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 508 08e4 19FB1AFC 	>>  smulbt tmp,poly7,twiddle
 508 08e8 19FB3AF9 	>>  smultt poly7,poly7,twiddle
 508              	>>  montgomery q,qinv,tmp,tmp2
 508 08ec 1CFB1BFE 	>>>  smulbt tmp2,tmp,qinv
 508 08f0 1BFB0ECE 	>>>  smlabb tmp2,q,tmp2,tmp
 508              	>>  montgomery q,qinv,poly7,tmp
 508 08f4 19FB1BFC 	>>>  smulbt tmp,poly7,qinv
 508 08f8 1BFB0C9C 	>>>  smlabb tmp,q,tmp,poly7
 508 08fc CCEA2E4E 	>>  pkhtb tmp2,tmp,tmp2,asr#16
 508 0900 D5FA4EF9 	>>  usub16 poly7,poly3,tmp2
 508 0904 95FA4EF5 	>>  uadd16 poly3,poly3,tmp2
 508              	> 
 509              	
 510              	    // multiply coeffs by layer 4 twiddles for later use
 511 0908 16EE10AA 	    vmov twiddle, s12
 512              	    mul_twiddle b, poly0, twiddle, tmp, tmp2, q, qinv // could be omitted but kept for reduction on
 512 090c 12FB0AFC 	>  smulbb tmp,poly0,twiddle
 512 0910 12FB2AF2 	>  smultb poly0,poly0,twiddle
 512              	>  montgomery q,qinv,tmp,tmp2
 512 0914 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 512 0918 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 512              	>  montgomery q,qinv,poly0,tmp
 512 091c 12FB1BFC 	>>  smulbt tmp,poly0,qinv
 512 0920 1BFB0C2C 	>>  smlabb tmp,q,tmp,poly0
 512 0924 CCEA2E42 	>  pkhtb poly0,tmp,tmp2,asr#16
 513              	    mul_twiddle t, poly1, twiddle, tmp, tmp2, q, qinv
 513 0928 13FB1AFC 	>  smulbt tmp,poly1,twiddle
 513 092c 13FB3AF3 	>  smultt poly1,poly1,twiddle
 513              	>  montgomery q,qinv,tmp,tmp2
 513 0930 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 513 0934 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 513              	>  montgomery q,qinv,poly1,tmp
 513 0938 13FB1BFC 	>>  smulbt tmp,poly1,qinv
 513 093c 1BFB0C3C 	>>  smlabb tmp,q,tmp,poly1
 513 0940 CCEA2E43 	>  pkhtb poly1,tmp,tmp2,asr#16
 514              	
 515 0944 16EE90AA 	    vmov twiddle, s13
 516              	    mul_twiddle b, poly2, twiddle, tmp, tmp2, q, qinv
 516 0948 14FB0AFC 	>  smulbb tmp,poly2,twiddle
 516 094c 14FB2AF4 	>  smultb poly2,poly2,twiddle
 516              	>  montgomery q,qinv,tmp,tmp2
 516 0950 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 516 0954 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 516              	>  montgomery q,qinv,poly2,tmp
 516 0958 14FB1BFC 	>>  smulbt tmp,poly2,qinv
 516 095c 1BFB0C4C 	>>  smlabb tmp,q,tmp,poly2
 516 0960 CCEA2E44 	>  pkhtb poly2,tmp,tmp2,asr#16
 517              	    mul_twiddle t, poly3, twiddle, tmp, tmp2, q, qinv
 517 0964 15FB1AFC 	>  smulbt tmp,poly3,twiddle
 517 0968 15FB3AF5 	>  smultt poly3,poly3,twiddle
 517              	>  montgomery q,qinv,tmp,tmp2
 517 096c 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 26


 517 0970 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 517              	>  montgomery q,qinv,poly3,tmp
 517 0974 15FB1BFC 	>>  smulbt tmp,poly3,qinv
 517 0978 1BFB0C5C 	>>  smlabb tmp,q,tmp,poly3
 517 097c CCEA2E45 	>  pkhtb poly3,tmp,tmp2,asr#16
 518              	
 519 0980 17EE10AA 	    vmov twiddle, s14
 520              	    mul_twiddle b, poly4, twiddle, tmp, tmp2, q, qinv
 520 0984 16FB0AFC 	>  smulbb tmp,poly4,twiddle
 520 0988 16FB2AF6 	>  smultb poly4,poly4,twiddle
 520              	>  montgomery q,qinv,tmp,tmp2
 520 098c 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 520 0990 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 520              	>  montgomery q,qinv,poly4,tmp
 520 0994 16FB1BFC 	>>  smulbt tmp,poly4,qinv
 520 0998 1BFB0C6C 	>>  smlabb tmp,q,tmp,poly4
 520 099c CCEA2E46 	>  pkhtb poly4,tmp,tmp2,asr#16
 521              	    mul_twiddle t, poly5, twiddle, tmp, tmp2, q, qinv
 521 09a0 17FB1AFC 	>  smulbt tmp,poly5,twiddle
 521 09a4 17FB3AF7 	>  smultt poly5,poly5,twiddle
 521              	>  montgomery q,qinv,tmp,tmp2
 521 09a8 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 521 09ac 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 521              	>  montgomery q,qinv,poly5,tmp
 521 09b0 17FB1BFC 	>>  smulbt tmp,poly5,qinv
 521 09b4 1BFB0C7C 	>>  smlabb tmp,q,tmp,poly5
 521 09b8 CCEA2E47 	>  pkhtb poly5,tmp,tmp2,asr#16
 522              	
 523 09bc 17EE90AA 	    vmov twiddle, s15
 524              	    mul_twiddle b, poly6, twiddle, tmp, tmp2, q, qinv
 524 09c0 18FB0AFC 	>  smulbb tmp,poly6,twiddle
 524 09c4 18FB2AF8 	>  smultb poly6,poly6,twiddle
 524              	>  montgomery q,qinv,tmp,tmp2
 524 09c8 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 524 09cc 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 524              	>  montgomery q,qinv,poly6,tmp
 524 09d0 18FB1BFC 	>>  smulbt tmp,poly6,qinv
 524 09d4 1BFB0C8C 	>>  smlabb tmp,q,tmp,poly6
 524 09d8 CCEA2E48 	>  pkhtb poly6,tmp,tmp2,asr#16
 525              	    mul_twiddle t, poly7, twiddle, tmp, tmp2, q, qinv
 525 09dc 19FB1AFC 	>  smulbt tmp,poly7,twiddle
 525 09e0 19FB3AF9 	>  smultt poly7,poly7,twiddle
 525              	>  montgomery q,qinv,tmp,tmp2
 525 09e4 1CFB1BFE 	>>  smulbt tmp2,tmp,qinv
 525 09e8 1BFB0ECE 	>>  smlabb tmp2,q,tmp2,tmp
 525              	>  montgomery q,qinv,poly7,tmp
 525 09ec 19FB1BFC 	>>  smulbt tmp,poly7,qinv
 525 09f0 1BFB0C9C 	>>  smlabb tmp,q,tmp,poly7
 525 09f4 CCEA2E49 	>  pkhtb poly7,tmp,tmp2,asr#16
 526              	
 527 09f8 00EE102A 	    vmov s0, poly0 // a1
 528 09fc 00EE903A 	    vmov s1, poly1 // a3
 529 0a00 01EE104A 	    vmov s2, poly2 // a5
 530 0a04 01EE905A 	    vmov s3, poly3 // a7
 531 0a08 02EE106A 	    vmov s4, poly4 // a9
 532 0a0c 02EE907A 	    vmov s5, poly5 // a11
 533 0a10 03EE108A 	    vmov s6, poly6 // a13
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 27


 534 0a14 03EE909A 	    vmov s7, poly7 // a15
 535              	
 536              	    // ----------
 537              	
 538              	    // load a0, a2, ..., a14
 539              	    load poly, poly0, poly1, poly2, poly3, #0, #distance/4, #2*distance/4, #3*distance/4
 539 0a18 D0F80020 	>  ldr.w poly0,[poly,#0]
 539 0a1c D0F80430 	>  ldr.w poly1,[poly,#distance/4]
 539 0a20 D0F80840 	>  ldr.w poly2,[poly,#2*distance/4]
 539 0a24 D0F80C50 	>  ldr.w poly3,[poly,#3*distance/4]
 540              	    load poly, poly4, poly5, poly6, poly7, #distance, #5*distance/4, #6*distance/4, #7*distance/4
 540 0a28 D0F81060 	>  ldr.w poly4,[poly,#distance]
 540 0a2c D0F81470 	>  ldr.w poly5,[poly,#5*distance/4]
 540 0a30 D0F81880 	>  ldr.w poly6,[poly,#6*distance/4]
 540 0a34 D0F81C90 	>  ldr.w poly7,[poly,#7*distance/4]
 541              	
 542              	    // NTT on a0, a2, ..., a14
 543              	    _3_layer_double_inv_CT_16_light poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, s8, s9,
 543              	> 
 543              	> 
 543 0a38 92FA03FC 	>  sadd16.w tmp,poly0,poly1
 543 0a3c D2FA03F3 	>  ssub16.w poly1,poly0,poly1
 543 0a40 94FA05FE 	>  sadd16.w tmp2,poly2,poly3
 543 0a44 D4FA05F5 	>  ssub16.w poly3,poly2,poly3
 543              	> 
 543 0a48 96FA07F2 	>  sadd16.w poly0,poly4,poly5
 543 0a4c D6FA07F7 	>  ssub16.w poly5,poly4,poly5
 543 0a50 98FA09F4 	>  sadd16.w poly2,poly6,poly7
 543 0a54 D8FA09F9 	>  ssub16.w poly7,poly6,poly7
 543              	> 
 543              	> 
 543              	> 
 543 0a58 9CFA0EF8 	>  sadd16.w poly6,tmp,tmp2
 543 0a5c DCFA0EFE 	>  ssub16.w tmp2,tmp,tmp2
 543 0a60 92FA04F6 	>  sadd16.w poly4,poly0,poly2
 543 0a64 D2FA04F4 	>  ssub16.w poly2,poly0,poly2
 543              	> 
 543 0a68 14EE90AA 	>  vmov.w twiddle,s9
 543              	>  doublebutterfly t,poly1,poly3,twiddle,tmp,poly0,q,qinv
 543 0a6c 15FB1AFC 	>>  smulbt tmp,poly3,twiddle
 543 0a70 15FB3AF5 	>>  smultt poly3,poly3,twiddle
 543              	>>  montgomery q,qinv,tmp,poly0
 543 0a74 1CFB1BF2 	>>>  smulbt poly0,tmp,qinv
 543 0a78 1BFB02C2 	>>>  smlabb poly0,q,poly0,tmp
 543              	>>  montgomery q,qinv,poly3,tmp
 543 0a7c 15FB1BFC 	>>>  smulbt tmp,poly3,qinv
 543 0a80 1BFB0C5C 	>>>  smlabb tmp,q,tmp,poly3
 543 0a84 CCEA2242 	>>  pkhtb poly0,tmp,poly0,asr#16
 543 0a88 D3FA42F5 	>>  usub16 poly3,poly1,poly0
 543 0a8c 93FA42F3 	>>  uadd16 poly1,poly1,poly0
 543              	>  doublebutterfly t,poly5,poly7,twiddle,tmp,poly0,q,qinv
 543 0a90 19FB1AFC 	>>  smulbt tmp,poly7,twiddle
 543 0a94 19FB3AF9 	>>  smultt poly7,poly7,twiddle
 543              	>>  montgomery q,qinv,tmp,poly0
 543 0a98 1CFB1BF2 	>>>  smulbt poly0,tmp,qinv
 543 0a9c 1BFB02C2 	>>>  smlabb poly0,q,poly0,tmp
 543              	>>  montgomery q,qinv,poly7,tmp
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 28


 543 0aa0 19FB1BFC 	>>>  smulbt tmp,poly7,qinv
 543 0aa4 1BFB0C9C 	>>>  smlabb tmp,q,tmp,poly7
 543 0aa8 CCEA2242 	>>  pkhtb poly0,tmp,poly0,asr#16
 543 0aac D7FA42F9 	>>  usub16 poly7,poly5,poly0
 543 0ab0 97FA42F7 	>>  uadd16 poly5,poly5,poly0
 543              	> 
 543              	> 
 543              	> 
 543 0ab4 98FA06F2 	>  sadd16.w poly0,poly6,poly4
 543 0ab8 D8FA06F6 	>  ssub16.w poly4,poly6,poly4
 543              	> 
 543 0abc 15EE10AA 	>  vmov.w twiddle,s10
 543              	>  doublebutterfly t,poly1,poly5,twiddle,tmp,poly6,q,qinv
 543 0ac0 17FB1AFC 	>>  smulbt tmp,poly5,twiddle
 543 0ac4 17FB3AF7 	>>  smultt poly5,poly5,twiddle
 543              	>>  montgomery q,qinv,tmp,poly6
 543 0ac8 1CFB1BF8 	>>>  smulbt poly6,tmp,qinv
 543 0acc 1BFB08C8 	>>>  smlabb poly6,q,poly6,tmp
 543              	>>  montgomery q,qinv,poly5,tmp
 543 0ad0 17FB1BFC 	>>>  smulbt tmp,poly5,qinv
 543 0ad4 1BFB0C7C 	>>>  smlabb tmp,q,tmp,poly5
 543 0ad8 CCEA2848 	>>  pkhtb poly6,tmp,poly6,asr#16
 543 0adc D3FA48F7 	>>  usub16 poly5,poly1,poly6
 543 0ae0 93FA48F3 	>>  uadd16 poly1,poly1,poly6
 543              	> 
 543 0ae4 15EE90AA 	>  vmov.w twiddle,s11
 543              	> 
 543 0ae8 14FB0AFC 	>  smulbb tmp,poly2,twiddle
 543 0aec 14FB2AF4 	>  smultb poly2,poly2,twiddle
 543              	>  montgomery_inplace q,qinv,tmp,poly6
 543 0af0 1CFB1BF8 	>>  smulbt poly6,tmp,qinv
 543 0af4 1BFB08CC 	>>  smlabb tmp,q,poly6,tmp
 543              	>  montgomery_inplace q,qinv,poly2,poly6
 543 0af8 14FB1BF8 	>>  smulbt poly6,poly2,qinv
 543 0afc 1BFB0844 	>>  smlabb poly2,q,poly6,poly2
 543 0b00 C4EA2C4C 	>  pkhtb tmp,poly2,tmp,asr#16
 543 0b04 DEFA0CF8 	>  ssub16.w poly6,tmp2,tmp
 543 0b08 9EFA0CF4 	>  sadd16.w poly2,tmp2,tmp
 543              	> 
 543              	>  doublebutterfly t,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 543 0b0c 19FB1AFC 	>>  smulbt tmp,poly7,twiddle
 543 0b10 19FB3AF9 	>>  smultt poly7,poly7,twiddle
 543              	>>  montgomery q,qinv,tmp,tmp2
 543 0b14 1CFB1BFE 	>>>  smulbt tmp2,tmp,qinv
 543 0b18 1BFB0ECE 	>>>  smlabb tmp2,q,tmp2,tmp
 543              	>>  montgomery q,qinv,poly7,tmp
 543 0b1c 19FB1BFC 	>>>  smulbt tmp,poly7,qinv
 543 0b20 1BFB0C9C 	>>>  smlabb tmp,q,tmp,poly7
 543 0b24 CCEA2E4E 	>>  pkhtb tmp2,tmp,tmp2,asr#16
 543 0b28 D5FA4EF9 	>>  usub16 poly7,poly3,tmp2
 543 0b2c 95FA4EF5 	>>  uadd16 poly3,poly3,tmp2
 543              	> 
 544              	
 545              	    // layer 4 - 1
 546              	    // addsub: (a2, a6, a10, a14), (a3, a7, a11, a15)
 547 0b30 10EE90EA 	    vmov tmp2, s1 // load a3
 548 0b34 00EE902A 	    vmov s1, poly0 // preserve a0
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 29


 549 0b38 93FA4EF2 	    uadd16 poly0, poly1, tmp2
 550 0b3c D3FA4EF3 	    usub16 poly1, poly1, tmp2
 551              	
 552 0b40 11EE90EA 	    vmov tmp2, s3 // load a7
 553 0b44 01EE904A 	    vmov s3, poly2 // preserve a4
 554 0b48 95FA4EF4 	    uadd16 poly2, poly3, tmp2
 555 0b4c D5FA4EF5 	    usub16 poly3, poly3, tmp2
 556              	
 557 0b50 12EE90EA 	    vmov tmp2, s5 // load a11
 558 0b54 02EE906A 	    vmov s5, poly4 // preserve a8
 559 0b58 97FA4EF6 	    uadd16 poly4, poly5, tmp2
 560 0b5c D7FA4EF7 	    usub16 poly5, poly5, tmp2
 561              	
 562 0b60 13EE90EA 	    vmov tmp2, s7 // load a15
 563 0b64 03EE908A 	    vmov s7, poly6 // preserve a12
 564 0b68 99FA4EF8 	    uadd16 poly6, poly7, tmp2
 565 0b6c D9FA4EF9 	    usub16 poly7, poly7, tmp2
 566              	
 567 0b70 C0F80420 	    str.w poly0, [poly, #1*distance/4]
 568 0b74 C0F82430 	    str.w poly1, [poly, #1*distance/4+offset]
 569 0b78 C0F80C40 	    str.w poly2, [poly, #3*distance/4]
 570 0b7c C0F82C50 	    str.w poly3, [poly, #3*distance/4+offset]
 571 0b80 C0F81460 	    str.w poly4, [poly, #5*distance/4]
 572 0b84 C0F83470 	    str.w poly5, [poly, #5*distance/4+offset]
 573 0b88 C0F81C80 	    str.w poly6, [poly, #7*distance/4]
 574 0b8c C0F83C90 	    str.w poly7, [poly, #7*distance/4+offset]
 575              	
 576              	    // layer 4 - 2
 577              	    // addsub: (a0, a4, a8, a12), (a1, a5, a9, a13)
 578 0b90 10EE90EA 	    vmov tmp2, s1 // load a0
 579 0b94 10EE103A 	    vmov poly1, s0 // load a1
 580 0b98 9EFA43F2 	    uadd16 poly0, tmp2, poly1
 581 0b9c DEFA43F3 	    usub16 poly1, tmp2, poly1
 582              	
 583 0ba0 11EE90EA 	    vmov tmp2, s3 // load a4
 584 0ba4 11EE105A 	    vmov poly3, s2 // load a5
 585 0ba8 9EFA45F4 	    uadd16 poly2, tmp2, poly3
 586 0bac DEFA45F5 	    usub16 poly3, tmp2, poly3
 587              	
 588 0bb0 12EE90EA 	    vmov tmp2, s5 // load a8
 589 0bb4 12EE107A 	    vmov poly5, s4 // load a9
 590 0bb8 9EFA47F6 	    uadd16 poly4, tmp2, poly5
 591 0bbc DEFA47F7 	    usub16 poly5, tmp2, poly5
 592              	
 593 0bc0 13EE90EA 	    vmov tmp2, s7 // load a12
 594 0bc4 13EE109A 	    vmov poly7, s6 // load a13
 595 0bc8 9EFA49F8 	    uadd16 poly6, tmp2, poly7
 596 0bcc DEFA49F9 	    usub16 poly7, tmp2, poly7
 597              	
 598 0bd0 C0F82030 	    str.w poly1, [poly, #offset]
 599 0bd4 C0F80840 	    str.w poly2, [poly, #2*distance/4]
 600 0bd8 C0F82850 	    str.w poly3, [poly, #2*distance/4+offset]
 601 0bdc C0F81060 	    str.w poly4, [poly, #4*distance/4]
 602 0be0 C0F83070 	    str.w poly5, [poly, #4*distance/4+offset]
 603 0be4 C0F81880 	    str.w poly6, [poly, #6*distance/4]
 604 0be8 C0F83890 	    str.w poly7, [poly, #6*distance/4+offset]
 605 0bec 40F8402B 	    str.w poly0, [poly], #strincr // increase 2*8*4 = 64 (2 * 8 loads of 4 bytes each)
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 30


 606              	
 607 0bf0 14EE10CA 	    vmov tmp, s8
 608 0bf4 B0EB0C0F 	    cmp.w poly, tmp
 609 0bf8 7FF4FAAD 	  bne.w 1b
 610              	
 611 0bfc A0F50070 	  sub.w poly, #8*strincr
 612              	
 613              	  ### LAYER 3+2+1
 614              	  .equ distance, distance*16
 615              	  .equ strincr, 4
 616              	
 617              	  // ITER 0
 618              	  load poly, poly0, poly1, poly2, poly3, #0, #distance/4, #2*distance/4, #3*distance/4
 618 0c00 D0F80020 	>  ldr.w poly0,[poly,#0]
 618 0c04 D0F84030 	>  ldr.w poly1,[poly,#distance/4]
 618 0c08 D0F88040 	>  ldr.w poly2,[poly,#2*distance/4]
 618 0c0c D0F8C050 	>  ldr.w poly3,[poly,#3*distance/4]
 619              	  load poly, poly4, poly5, poly6, poly7, #distance, #5*distance/4, #6*distance/4, #7*distance/4
 619 0c10 D0F80061 	>  ldr.w poly4,[poly,#distance]
 619 0c14 D0F84071 	>  ldr.w poly5,[poly,#5*distance/4]
 619 0c18 D0F88081 	>  ldr.w poly6,[poly,#6*distance/4]
 619 0c1c D0F8C091 	>  ldr.w poly7,[poly,#7*distance/4]
 620              	
 621 0c20 F1EC032A 	  vldm twiddle_ptr!, {s5-s7}
 622              	
 623              	  _3_layer_double_inv_CT_16_light_reduce poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, s5
 623              	> 
 623              	> 
 623 0c24 92FA03FC 	>  sadd16.w tmp,poly0,poly1
 623 0c28 D2FA03F3 	>  ssub16.w poly1,poly0,poly1
 623 0c2c 94FA05FE 	>  sadd16.w tmp2,poly2,poly3
 623 0c30 D4FA05F5 	>  ssub16.w poly3,poly2,poly3
 623              	> 
 623 0c34 96FA07F2 	>  sadd16.w poly0,poly4,poly5
 623 0c38 D6FA07F7 	>  ssub16.w poly5,poly4,poly5
 623 0c3c 98FA09F4 	>  sadd16.w poly2,poly6,poly7
 623 0c40 D8FA09F9 	>  ssub16.w poly7,poly6,poly7
 623              	> 
 623              	> 
 623 0c44 4FEA0C08 	>  mov.w poly6,tmp
 623 0c48 4FEA0206 	>  mov.w poly4,poly0
 623              	> 
 623              	> 
 623 0c4c 12EE90AA 	>  vmov.w twiddle,s5
 623              	>  doublebutterfly b,poly6,tmp2,twiddle,tmp,poly0,q,qinv
 623 0c50 1EFB0AFC 	>>  smulbb tmp,tmp2,twiddle
 623 0c54 1EFB2AFE 	>>  smultb tmp2,tmp2,twiddle
 623              	>>  montgomery q,qinv,tmp,poly0
 623 0c58 1CFB1BF2 	>>>  smulbt poly0,tmp,qinv
 623 0c5c 1BFB02C2 	>>>  smlabb poly0,q,poly0,tmp
 623              	>>  montgomery q,qinv,tmp2,tmp
 623 0c60 1EFB1BFC 	>>>  smulbt tmp,tmp2,qinv
 623 0c64 1BFB0CEC 	>>>  smlabb tmp,q,tmp,tmp2
 623 0c68 CCEA2242 	>>  pkhtb poly0,tmp,poly0,asr#16
 623 0c6c D8FA42FE 	>>  usub16 tmp2,poly6,poly0
 623 0c70 98FA42F8 	>>  uadd16 poly6,poly6,poly0
 623              	>  doublebutterfly b,poly4,poly2,twiddle,tmp,poly0,q,qinv
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 31


 623 0c74 14FB0AFC 	>>  smulbb tmp,poly2,twiddle
 623 0c78 14FB2AF4 	>>  smultb poly2,poly2,twiddle
 623              	>>  montgomery q,qinv,tmp,poly0
 623 0c7c 1CFB1BF2 	>>>  smulbt poly0,tmp,qinv
 623 0c80 1BFB02C2 	>>>  smlabb poly0,q,poly0,tmp
 623              	>>  montgomery q,qinv,poly2,tmp
 623 0c84 14FB1BFC 	>>>  smulbt tmp,poly2,qinv
 623 0c88 1BFB0C4C 	>>>  smlabb tmp,q,tmp,poly2
 623 0c8c CCEA2242 	>>  pkhtb poly0,tmp,poly0,asr#16
 623 0c90 D6FA42F4 	>>  usub16 poly2,poly4,poly0
 623 0c94 96FA42F6 	>>  uadd16 poly4,poly4,poly0
 623              	>  doublebutterfly t,poly1,poly3,twiddle,tmp,poly0,q,qinv
 623 0c98 15FB1AFC 	>>  smulbt tmp,poly3,twiddle
 623 0c9c 15FB3AF5 	>>  smultt poly3,poly3,twiddle
 623              	>>  montgomery q,qinv,tmp,poly0
 623 0ca0 1CFB1BF2 	>>>  smulbt poly0,tmp,qinv
 623 0ca4 1BFB02C2 	>>>  smlabb poly0,q,poly0,tmp
 623              	>>  montgomery q,qinv,poly3,tmp
 623 0ca8 15FB1BFC 	>>>  smulbt tmp,poly3,qinv
 623 0cac 1BFB0C5C 	>>>  smlabb tmp,q,tmp,poly3
 623 0cb0 CCEA2242 	>>  pkhtb poly0,tmp,poly0,asr#16
 623 0cb4 D3FA42F5 	>>  usub16 poly3,poly1,poly0
 623 0cb8 93FA42F3 	>>  uadd16 poly1,poly1,poly0
 623              	>  doublebutterfly t,poly5,poly7,twiddle,tmp,poly0,q,qinv
 623 0cbc 19FB1AFC 	>>  smulbt tmp,poly7,twiddle
 623 0cc0 19FB3AF9 	>>  smultt poly7,poly7,twiddle
 623              	>>  montgomery q,qinv,tmp,poly0
 623 0cc4 1CFB1BF2 	>>>  smulbt poly0,tmp,qinv
 623 0cc8 1BFB02C2 	>>>  smlabb poly0,q,poly0,tmp
 623              	>>  montgomery q,qinv,poly7,tmp
 623 0ccc 19FB1BFC 	>>>  smulbt tmp,poly7,qinv
 623 0cd0 1BFB0C9C 	>>>  smlabb tmp,q,tmp,poly7
 623 0cd4 CCEA2242 	>>  pkhtb poly0,tmp,poly0,asr#16
 623 0cd8 D7FA42F9 	>>  usub16 poly7,poly5,poly0
 623 0cdc 97FA42F7 	>>  uadd16 poly5,poly5,poly0
 623              	> 
 623              	> 
 623              	> 
 623 0ce0 98FA06F2 	>  sadd16.w poly0,poly6,poly4
 623 0ce4 D8FA06F6 	>  ssub16.w poly4,poly6,poly4
 623              	> 
 623 0ce8 13EE10AA 	>  vmov.w twiddle,s6
 623              	>  doublebutterfly t,poly1,poly5,twiddle,tmp,poly6,q,qinv
 623 0cec 17FB1AFC 	>>  smulbt tmp,poly5,twiddle
 623 0cf0 17FB3AF7 	>>  smultt poly5,poly5,twiddle
 623              	>>  montgomery q,qinv,tmp,poly6
 623 0cf4 1CFB1BF8 	>>>  smulbt poly6,tmp,qinv
 623 0cf8 1BFB08C8 	>>>  smlabb poly6,q,poly6,tmp
 623              	>>  montgomery q,qinv,poly5,tmp
 623 0cfc 17FB1BFC 	>>>  smulbt tmp,poly5,qinv
 623 0d00 1BFB0C7C 	>>>  smlabb tmp,q,tmp,poly5
 623 0d04 CCEA2848 	>>  pkhtb poly6,tmp,poly6,asr#16
 623 0d08 D3FA48F7 	>>  usub16 poly5,poly1,poly6
 623 0d0c 93FA48F3 	>>  uadd16 poly1,poly1,poly6
 623              	> 
 623 0d10 13EE90AA 	>  vmov.w twiddle,s7
 623              	> 
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 32


 623 0d14 14FB0AFC 	>  smulbb tmp,poly2,twiddle
 623 0d18 14FB2AF4 	>  smultb poly2,poly2,twiddle
 623              	>  montgomery_inplace q,qinv,tmp,poly6
 623 0d1c 1CFB1BF8 	>>  smulbt poly6,tmp,qinv
 623 0d20 1BFB08CC 	>>  smlabb tmp,q,poly6,tmp
 623              	>  montgomery_inplace q,qinv,poly2,poly6
 623 0d24 14FB1BF8 	>>  smulbt poly6,poly2,qinv
 623 0d28 1BFB0844 	>>  smlabb poly2,q,poly6,poly2
 623 0d2c C4EA2C4C 	>  pkhtb tmp,poly2,tmp,asr#16
 623 0d30 DEFA0CF8 	>  ssub16.w poly6,tmp2,tmp
 623 0d34 9EFA0CF4 	>  sadd16.w poly2,tmp2,tmp
 623              	> 
 623              	>  doublebutterfly t,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 623 0d38 19FB1AFC 	>>  smulbt tmp,poly7,twiddle
 623 0d3c 19FB3AF9 	>>  smultt poly7,poly7,twiddle
 623              	>>  montgomery q,qinv,tmp,tmp2
 623 0d40 1CFB1BFE 	>>>  smulbt tmp2,tmp,qinv
 623 0d44 1BFB0ECE 	>>>  smlabb tmp2,q,tmp2,tmp
 623              	>>  montgomery q,qinv,poly7,tmp
 623 0d48 19FB1BFC 	>>>  smulbt tmp,poly7,qinv
 623 0d4c 1BFB0C9C 	>>>  smlabb tmp,q,tmp,poly7
 623 0d50 CCEA2E4E 	>>  pkhtb tmp2,tmp,tmp2,asr#16
 623 0d54 D5FA4EF9 	>>  usub16 poly7,poly3,tmp2
 623 0d58 95FA4EF5 	>>  uadd16 poly3,poly3,tmp2
 623              	> 
 624              	
 625 0d5c 01EE100A 	  vmov.w s2, poly
 626 0d60 43F6ED00 	  movw poly, #:lower16:5585133
 627 0d64 C0F25500 	  movt poly, #:upper16:5585133
 628              	
 629              	  // twisting
 630              	  _3_layer_double_inv_twist_16 poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, twiddle, twi
 630              	> 
 630 0d68 C0F2000B 	>  movt q,#0
 630              	> 
 630 0d6c 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 630              	> 
 630              	>  mul_twiddle_barrett_32 b,poly0,twiddle,poly,q,tmp,tmp2
 630 0d70 12FB0AFC 	>>  smulbb tmp,poly0,twiddle
 630 0d74 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 630 0d78 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 630 0d7c 12FB2AF2 	>>  smultb poly0,poly0,twiddle
 630 0d80 52FB10FE 	>>  smmulr.w tmp2,poly0,poly
 630 0d84 0EFB1B22 	>>  mls.w poly0,tmp2,q,poly0
 630 0d88 CCEA0242 	>>  pkhbt poly0,tmp,poly0,lsl#16
 630              	>  mul_twiddle_barrett_32 t,poly1,twiddle,poly,q,tmp,tmp2
 630 0d8c 13FB1AFC 	>>  smulbt tmp,poly1,twiddle
 630 0d90 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 630 0d94 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 630 0d98 13FB3AF3 	>>  smultt poly1,poly1,twiddle
 630 0d9c 53FB10FE 	>>  smmulr.w tmp2,poly1,poly
 630 0da0 0EFB1B33 	>>  mls.w poly1,tmp2,q,poly1
 630 0da4 CCEA0343 	>>  pkhbt poly1,tmp,poly1,lsl#16
 630              	> 
 630 0da8 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 630              	> 
 630              	>  mul_twiddle_barrett_32 b,poly2,twiddle,poly,q,tmp,tmp2
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 33


 630 0dac 14FB0AFC 	>>  smulbb tmp,poly2,twiddle
 630 0db0 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 630 0db4 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 630 0db8 14FB2AF4 	>>  smultb poly2,poly2,twiddle
 630 0dbc 54FB10FE 	>>  smmulr.w tmp2,poly2,poly
 630 0dc0 0EFB1B44 	>>  mls.w poly2,tmp2,q,poly2
 630 0dc4 CCEA0444 	>>  pkhbt poly2,tmp,poly2,lsl#16
 630              	>  mul_twiddle_barrett_32 t,poly3,twiddle,poly,q,tmp,tmp2
 630 0dc8 15FB1AFC 	>>  smulbt tmp,poly3,twiddle
 630 0dcc 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 630 0dd0 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 630 0dd4 15FB3AF5 	>>  smultt poly3,poly3,twiddle
 630 0dd8 55FB10FE 	>>  smmulr.w tmp2,poly3,poly
 630 0ddc 0EFB1B55 	>>  mls.w poly3,tmp2,q,poly3
 630 0de0 CCEA0545 	>>  pkhbt poly3,tmp,poly3,lsl#16
 630              	> 
 630 0de4 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 630              	> 
 630              	>  mul_twiddle_barrett_32 b,poly4,twiddle,poly,q,tmp,tmp2
 630 0de8 16FB0AFC 	>>  smulbb tmp,poly4,twiddle
 630 0dec 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 630 0df0 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 630 0df4 16FB2AF6 	>>  smultb poly4,poly4,twiddle
 630 0df8 56FB10FE 	>>  smmulr.w tmp2,poly4,poly
 630 0dfc 0EFB1B66 	>>  mls.w poly4,tmp2,q,poly4
 630 0e00 CCEA0646 	>>  pkhbt poly4,tmp,poly4,lsl#16
 630              	>  mul_twiddle_barrett_32 t,poly5,twiddle,poly,q,tmp,tmp2
 630 0e04 17FB1AFC 	>>  smulbt tmp,poly5,twiddle
 630 0e08 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 630 0e0c 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 630 0e10 17FB3AF7 	>>  smultt poly5,poly5,twiddle
 630 0e14 57FB10FE 	>>  smmulr.w tmp2,poly5,poly
 630 0e18 0EFB1B77 	>>  mls.w poly5,tmp2,q,poly5
 630 0e1c CCEA0747 	>>  pkhbt poly5,tmp,poly5,lsl#16
 630              	> 
 630 0e20 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 630              	> 
 630              	>  mul_twiddle_barrett_32 b,poly6,twiddle,poly,q,tmp,tmp2
 630 0e24 18FB0AFC 	>>  smulbb tmp,poly6,twiddle
 630 0e28 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 630 0e2c 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 630 0e30 18FB2AF8 	>>  smultb poly6,poly6,twiddle
 630 0e34 58FB10FE 	>>  smmulr.w tmp2,poly6,poly
 630 0e38 0EFB1B88 	>>  mls.w poly6,tmp2,q,poly6
 630 0e3c CCEA0848 	>>  pkhbt poly6,tmp,poly6,lsl#16
 630              	>  mul_twiddle_barrett_32 t,poly7,twiddle,poly,q,tmp,tmp2
 630 0e40 19FB1AFC 	>>  smulbt tmp,poly7,twiddle
 630 0e44 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 630 0e48 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 630 0e4c 19FB3AF9 	>>  smultt poly7,poly7,twiddle
 630 0e50 59FB10FE 	>>  smmulr.w tmp2,poly7,poly
 630 0e54 0EFB1B99 	>>  mls.w poly7,tmp2,q,poly7
 630 0e58 CCEA0949 	>>  pkhbt poly7,tmp,poly7,lsl#16
 630              	> 
 630 0e5c C0F2FF2B 	>  movt q,#767
 630              	> 
 631              	
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 34


 632 0e60 11EE100A 	  vmov.w poly, s2
 633              	
 634              	  store poly, poly4, poly5, poly6, poly7, #distance, #5*distance/4, #6*distance/4, #7*distance/4
 634 0e64 C0F80061 	>  str.w poly4,[poly,#distance]
 634 0e68 C0F84071 	>  str.w poly5,[poly,#5*distance/4]
 634 0e6c C0F88081 	>  str.w poly6,[poly,#6*distance/4]
 634 0e70 C0F8C091 	>  str.w poly7,[poly,#7*distance/4]
 635 0e74 C0F84030 	  str.w poly1, [poly, #distance/4]
 636 0e78 C0F88040 	  str.w poly2, [poly, #2*distance/4]
 637 0e7c C0F8C050 	  str.w poly3, [poly, #3*distance/4]
 638 0e80 40F8042B 	  str.w poly0, [poly], #4
 639              	
 640              	  // ITER 1-12
 641 0e84 00F1300C 	  add.w tmp, poly, #strincr*3*(3+1)
 642 0e88 07EE10CA 	  vmov s14, tmp
 643              	  3:
 644 0e8c 00F10C0C 	    add.w tmp, poly, #strincr*3
 645 0e90 06EE90CA 	    vmov s13, tmp
 646              	    2:
 647              	      // polys upto 6q
 648              	      load poly, poly0, poly1, poly2, poly3, #0, #distance/4, #2*distance/4, #3*distance/4
 648 0e94 D0F80020 	>  ldr.w poly0,[poly,#0]
 648 0e98 D0F84030 	>  ldr.w poly1,[poly,#distance/4]
 648 0e9c D0F88040 	>  ldr.w poly2,[poly,#2*distance/4]
 648 0ea0 D0F8C050 	>  ldr.w poly3,[poly,#3*distance/4]
 649              	      load poly, poly4, poly5, poly6, poly7, #distance, #5*distance/4, #6*distance/4, #7*distance/4
 649 0ea4 D0F80061 	>  ldr.w poly4,[poly,#distance]
 649 0ea8 D0F84071 	>  ldr.w poly5,[poly,#5*distance/4]
 649 0eac D0F88081 	>  ldr.w poly6,[poly,#6*distance/4]
 649 0eb0 D0F8C091 	>  ldr.w poly7,[poly,#7*distance/4]
 650              	
 651              	
 652              	      _3_layer_double_inv_CT_16 poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, twiddle, tw
 652              	> 
 652 0eb4 31F802AB 	>  ldrh.w twiddle,[twiddle_ptr],#2
 652              	>  two_doublebutterfly b,b,poly0,poly1,poly2,poly3,twiddle,tmp,tmp2,q,qinv
 652              	>>  doublebutterfly b,poly0,poly1,twiddle,tmp,tmp2,q,qinv
 652 0eb8 13FB0AFC 	>>>  smulbb tmp,poly1,twiddle
 652 0ebc 13FB2AF3 	>>>  smultb poly1,poly1,twiddle
 652              	>>>  montgomery q,qinv,tmp,tmp2
 652 0ec0 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 652 0ec4 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 652              	>>>  montgomery q,qinv,poly1,tmp
 652 0ec8 13FB1BFC 	>>>>  smulbt tmp,poly1,qinv
 652 0ecc 1BFB0C3C 	>>>>  smlabb tmp,q,tmp,poly1
 652 0ed0 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 652 0ed4 D2FA4EF3 	>>>  usub16 poly1,poly0,tmp2
 652 0ed8 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 652              	>>  doublebutterfly b,poly2,poly3,twiddle,tmp,tmp2,q,qinv
 652 0edc 15FB0AFC 	>>>  smulbb tmp,poly3,twiddle
 652 0ee0 15FB2AF5 	>>>  smultb poly3,poly3,twiddle
 652              	>>>  montgomery q,qinv,tmp,tmp2
 652 0ee4 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 652 0ee8 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 652              	>>>  montgomery q,qinv,poly3,tmp
 652 0eec 15FB1BFC 	>>>>  smulbt tmp,poly3,qinv
 652 0ef0 1BFB0C5C 	>>>>  smlabb tmp,q,tmp,poly3
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 35


 652 0ef4 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 652 0ef8 D4FA4EF5 	>>>  usub16 poly3,poly2,tmp2
 652 0efc 94FA4EF4 	>>>  uadd16 poly2,poly2,tmp2
 652              	>  two_doublebutterfly b,b,poly4,poly5,poly6,poly7,twiddle,tmp,tmp2,q,qinv
 652              	>>  doublebutterfly b,poly4,poly5,twiddle,tmp,tmp2,q,qinv
 652 0f00 17FB0AFC 	>>>  smulbb tmp,poly5,twiddle
 652 0f04 17FB2AF7 	>>>  smultb poly5,poly5,twiddle
 652              	>>>  montgomery q,qinv,tmp,tmp2
 652 0f08 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 652 0f0c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 652              	>>>  montgomery q,qinv,poly5,tmp
 652 0f10 17FB1BFC 	>>>>  smulbt tmp,poly5,qinv
 652 0f14 1BFB0C7C 	>>>>  smlabb tmp,q,tmp,poly5
 652 0f18 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 652 0f1c D6FA4EF7 	>>>  usub16 poly5,poly4,tmp2
 652 0f20 96FA4EF6 	>>>  uadd16 poly4,poly4,tmp2
 652              	>>  doublebutterfly b,poly6,poly7,twiddle,tmp,tmp2,q,qinv
 652 0f24 19FB0AFC 	>>>  smulbb tmp,poly7,twiddle
 652 0f28 19FB2AF9 	>>>  smultb poly7,poly7,twiddle
 652              	>>>  montgomery q,qinv,tmp,tmp2
 652 0f2c 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 652 0f30 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 652              	>>>  montgomery q,qinv,poly7,tmp
 652 0f34 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 652 0f38 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 652 0f3c CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 652 0f40 D8FA4EF9 	>>>  usub16 poly7,poly6,tmp2
 652 0f44 98FA4EF8 	>>>  uadd16 poly6,poly6,tmp2
 652              	> 
 652              	> 
 652 0f48 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 652              	>  two_doublebutterfly b,t,poly0,poly2,poly1,poly3,twiddle,tmp,tmp2,q,qinv
 652              	>>  doublebutterfly b,poly0,poly2,twiddle,tmp,tmp2,q,qinv
 652 0f4c 14FB0AFC 	>>>  smulbb tmp,poly2,twiddle
 652 0f50 14FB2AF4 	>>>  smultb poly2,poly2,twiddle
 652              	>>>  montgomery q,qinv,tmp,tmp2
 652 0f54 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 652 0f58 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 652              	>>>  montgomery q,qinv,poly2,tmp
 652 0f5c 14FB1BFC 	>>>>  smulbt tmp,poly2,qinv
 652 0f60 1BFB0C4C 	>>>>  smlabb tmp,q,tmp,poly2
 652 0f64 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 652 0f68 D2FA4EF4 	>>>  usub16 poly2,poly0,tmp2
 652 0f6c 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 652              	>>  doublebutterfly t,poly1,poly3,twiddle,tmp,tmp2,q,qinv
 652 0f70 15FB1AFC 	>>>  smulbt tmp,poly3,twiddle
 652 0f74 15FB3AF5 	>>>  smultt poly3,poly3,twiddle
 652              	>>>  montgomery q,qinv,tmp,tmp2
 652 0f78 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 652 0f7c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 652              	>>>  montgomery q,qinv,poly3,tmp
 652 0f80 15FB1BFC 	>>>>  smulbt tmp,poly3,qinv
 652 0f84 1BFB0C5C 	>>>>  smlabb tmp,q,tmp,poly3
 652 0f88 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 652 0f8c D3FA4EF5 	>>>  usub16 poly3,poly1,tmp2
 652 0f90 93FA4EF3 	>>>  uadd16 poly1,poly1,tmp2
 652              	> 
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 36


 652              	>  two_doublebutterfly b,t,poly4,poly6,poly5,poly7,twiddle,tmp,tmp2,q,qinv
 652              	>>  doublebutterfly b,poly4,poly6,twiddle,tmp,tmp2,q,qinv
 652 0f94 18FB0AFC 	>>>  smulbb tmp,poly6,twiddle
 652 0f98 18FB2AF8 	>>>  smultb poly6,poly6,twiddle
 652              	>>>  montgomery q,qinv,tmp,tmp2
 652 0f9c 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 652 0fa0 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 652              	>>>  montgomery q,qinv,poly6,tmp
 652 0fa4 18FB1BFC 	>>>>  smulbt tmp,poly6,qinv
 652 0fa8 1BFB0C8C 	>>>>  smlabb tmp,q,tmp,poly6
 652 0fac CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 652 0fb0 D6FA4EF8 	>>>  usub16 poly6,poly4,tmp2
 652 0fb4 96FA4EF6 	>>>  uadd16 poly4,poly4,tmp2
 652              	>>  doublebutterfly t,poly5,poly7,twiddle,tmp,tmp2,q,qinv
 652 0fb8 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 652 0fbc 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 652              	>>>  montgomery q,qinv,tmp,tmp2
 652 0fc0 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 652 0fc4 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 652              	>>>  montgomery q,qinv,poly7,tmp
 652 0fc8 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 652 0fcc 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 652 0fd0 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 652 0fd4 D7FA4EF9 	>>>  usub16 poly7,poly5,tmp2
 652 0fd8 97FA4EF7 	>>>  uadd16 poly5,poly5,tmp2
 652              	> 
 652              	> 
 652 0fdc 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 652              	>  two_doublebutterfly b,t,poly0,poly4,poly1,poly5,twiddle,tmp,tmp2,q,qinv
 652              	>>  doublebutterfly b,poly0,poly4,twiddle,tmp,tmp2,q,qinv
 652 0fe0 16FB0AFC 	>>>  smulbb tmp,poly4,twiddle
 652 0fe4 16FB2AF6 	>>>  smultb poly4,poly4,twiddle
 652              	>>>  montgomery q,qinv,tmp,tmp2
 652 0fe8 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 652 0fec 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 652              	>>>  montgomery q,qinv,poly4,tmp
 652 0ff0 16FB1BFC 	>>>>  smulbt tmp,poly4,qinv
 652 0ff4 1BFB0C6C 	>>>>  smlabb tmp,q,tmp,poly4
 652 0ff8 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 652 0ffc D2FA4EF6 	>>>  usub16 poly4,poly0,tmp2
 652 1000 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 652              	>>  doublebutterfly t,poly1,poly5,twiddle,tmp,tmp2,q,qinv
 652 1004 17FB1AFC 	>>>  smulbt tmp,poly5,twiddle
 652 1008 17FB3AF7 	>>>  smultt poly5,poly5,twiddle
 652              	>>>  montgomery q,qinv,tmp,tmp2
 652 100c 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 652 1010 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 652              	>>>  montgomery q,qinv,poly5,tmp
 652 1014 17FB1BFC 	>>>>  smulbt tmp,poly5,qinv
 652 1018 1BFB0C7C 	>>>>  smlabb tmp,q,tmp,poly5
 652 101c CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 652 1020 D3FA4EF7 	>>>  usub16 poly5,poly1,tmp2
 652 1024 93FA4EF3 	>>>  uadd16 poly1,poly1,tmp2
 652              	> 
 652 1028 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 652              	>  two_doublebutterfly b,t,poly2,poly6,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 652              	>>  doublebutterfly b,poly2,poly6,twiddle,tmp,tmp2,q,qinv
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 37


 652 102c 18FB0AFC 	>>>  smulbb tmp,poly6,twiddle
 652 1030 18FB2AF8 	>>>  smultb poly6,poly6,twiddle
 652              	>>>  montgomery q,qinv,tmp,tmp2
 652 1034 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 652 1038 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 652              	>>>  montgomery q,qinv,poly6,tmp
 652 103c 18FB1BFC 	>>>>  smulbt tmp,poly6,qinv
 652 1040 1BFB0C8C 	>>>>  smlabb tmp,q,tmp,poly6
 652 1044 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 652 1048 D4FA4EF8 	>>>  usub16 poly6,poly2,tmp2
 652 104c 94FA4EF4 	>>>  uadd16 poly2,poly2,tmp2
 652              	>>  doublebutterfly t,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 652 1050 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 652 1054 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 652              	>>>  montgomery q,qinv,tmp,tmp2
 652 1058 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 652 105c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 652              	>>>  montgomery q,qinv,poly7,tmp
 652 1060 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 652 1064 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 652 1068 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 652 106c D5FA4EF9 	>>>  usub16 poly7,poly3,tmp2
 652 1070 95FA4EF5 	>>>  uadd16 poly3,poly3,tmp2
 653              	
 654 1074 01EE100A 	      vmov.w s2, poly
 655 1078 43F6ED00 	      movw poly, #:lower16:5585133
 656 107c C0F25500 	      movt poly, #:upper16:5585133
 657              	
 658              	      // twisting
 659              	      _3_layer_double_inv_twist_16 poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, twiddle,
 659              	> 
 659 1080 C0F2000B 	>  movt q,#0
 659              	> 
 659 1084 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 659              	> 
 659              	>  mul_twiddle_barrett_32 b,poly0,twiddle,poly,q,tmp,tmp2
 659 1088 12FB0AFC 	>>  smulbb tmp,poly0,twiddle
 659 108c 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 659 1090 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 659 1094 12FB2AF2 	>>  smultb poly0,poly0,twiddle
 659 1098 52FB10FE 	>>  smmulr.w tmp2,poly0,poly
 659 109c 0EFB1B22 	>>  mls.w poly0,tmp2,q,poly0
 659 10a0 CCEA0242 	>>  pkhbt poly0,tmp,poly0,lsl#16
 659              	>  mul_twiddle_barrett_32 t,poly1,twiddle,poly,q,tmp,tmp2
 659 10a4 13FB1AFC 	>>  smulbt tmp,poly1,twiddle
 659 10a8 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 659 10ac 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 659 10b0 13FB3AF3 	>>  smultt poly1,poly1,twiddle
 659 10b4 53FB10FE 	>>  smmulr.w tmp2,poly1,poly
 659 10b8 0EFB1B33 	>>  mls.w poly1,tmp2,q,poly1
 659 10bc CCEA0343 	>>  pkhbt poly1,tmp,poly1,lsl#16
 659              	> 
 659 10c0 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 659              	> 
 659              	>  mul_twiddle_barrett_32 b,poly2,twiddle,poly,q,tmp,tmp2
 659 10c4 14FB0AFC 	>>  smulbb tmp,poly2,twiddle
 659 10c8 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 38


 659 10cc 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 659 10d0 14FB2AF4 	>>  smultb poly2,poly2,twiddle
 659 10d4 54FB10FE 	>>  smmulr.w tmp2,poly2,poly
 659 10d8 0EFB1B44 	>>  mls.w poly2,tmp2,q,poly2
 659 10dc CCEA0444 	>>  pkhbt poly2,tmp,poly2,lsl#16
 659              	>  mul_twiddle_barrett_32 t,poly3,twiddle,poly,q,tmp,tmp2
 659 10e0 15FB1AFC 	>>  smulbt tmp,poly3,twiddle
 659 10e4 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 659 10e8 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 659 10ec 15FB3AF5 	>>  smultt poly3,poly3,twiddle
 659 10f0 55FB10FE 	>>  smmulr.w tmp2,poly3,poly
 659 10f4 0EFB1B55 	>>  mls.w poly3,tmp2,q,poly3
 659 10f8 CCEA0545 	>>  pkhbt poly3,tmp,poly3,lsl#16
 659              	> 
 659 10fc 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 659              	> 
 659              	>  mul_twiddle_barrett_32 b,poly4,twiddle,poly,q,tmp,tmp2
 659 1100 16FB0AFC 	>>  smulbb tmp,poly4,twiddle
 659 1104 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 659 1108 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 659 110c 16FB2AF6 	>>  smultb poly4,poly4,twiddle
 659 1110 56FB10FE 	>>  smmulr.w tmp2,poly4,poly
 659 1114 0EFB1B66 	>>  mls.w poly4,tmp2,q,poly4
 659 1118 CCEA0646 	>>  pkhbt poly4,tmp,poly4,lsl#16
 659              	>  mul_twiddle_barrett_32 t,poly5,twiddle,poly,q,tmp,tmp2
 659 111c 17FB1AFC 	>>  smulbt tmp,poly5,twiddle
 659 1120 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 659 1124 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 659 1128 17FB3AF7 	>>  smultt poly5,poly5,twiddle
 659 112c 57FB10FE 	>>  smmulr.w tmp2,poly5,poly
 659 1130 0EFB1B77 	>>  mls.w poly5,tmp2,q,poly5
 659 1134 CCEA0747 	>>  pkhbt poly5,tmp,poly5,lsl#16
 659              	> 
 659 1138 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 659              	> 
 659              	>  mul_twiddle_barrett_32 b,poly6,twiddle,poly,q,tmp,tmp2
 659 113c 18FB0AFC 	>>  smulbb tmp,poly6,twiddle
 659 1140 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 659 1144 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 659 1148 18FB2AF8 	>>  smultb poly6,poly6,twiddle
 659 114c 58FB10FE 	>>  smmulr.w tmp2,poly6,poly
 659 1150 0EFB1B88 	>>  mls.w poly6,tmp2,q,poly6
 659 1154 CCEA0848 	>>  pkhbt poly6,tmp,poly6,lsl#16
 659              	>  mul_twiddle_barrett_32 t,poly7,twiddle,poly,q,tmp,tmp2
 659 1158 19FB1AFC 	>>  smulbt tmp,poly7,twiddle
 659 115c 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 659 1160 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 659 1164 19FB3AF9 	>>  smultt poly7,poly7,twiddle
 659 1168 59FB10FE 	>>  smmulr.w tmp2,poly7,poly
 659 116c 0EFB1B99 	>>  mls.w poly7,tmp2,q,poly7
 659 1170 CCEA0949 	>>  pkhbt poly7,tmp,poly7,lsl#16
 659              	> 
 659 1174 C0F2FF2B 	>  movt q,#767
 659              	> 
 660              	
 661 1178 11EE100A 	      vmov.w poly, s2
 662              	
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 39


 663              	      store poly, poly4, poly5, poly6, poly7, #distance, #5*distance/4, #6*distance/4, #7*distance/
 663 117c C0F80061 	>  str.w poly4,[poly,#distance]
 663 1180 C0F84071 	>  str.w poly5,[poly,#5*distance/4]
 663 1184 C0F88081 	>  str.w poly6,[poly,#6*distance/4]
 663 1188 C0F8C091 	>  str.w poly7,[poly,#7*distance/4]
 664 118c C0F84030 	      str.w poly1, [poly, #distance/4]
 665 1190 C0F88040 	      str.w poly2, [poly, #2*distance/4]
 666 1194 C0F8C050 	      str.w poly3, [poly, #3*distance/4]
 667 1198 40F8042B 	      str.w poly0, [poly], #4
 668              	
 669 119c 16EE90CA 	      vmov tmp, s13
 670 11a0 B0EB0C0F 	      cmp.w poly, tmp
 671 11a4 7FF476AE 	    bne.w 2b
 672              	
 673              	    // polys upto 9q
 674              	    load poly, poly0, poly1, poly2, poly3, #0, #distance/4, #2*distance/4, #3*distance/4
 674 11a8 D0F80020 	>  ldr.w poly0,[poly,#0]
 674 11ac D0F84030 	>  ldr.w poly1,[poly,#distance/4]
 674 11b0 D0F88040 	>  ldr.w poly2,[poly,#2*distance/4]
 674 11b4 D0F8C050 	>  ldr.w poly3,[poly,#3*distance/4]
 675              	    load poly, poly4, poly5, poly6, poly7, #distance, #5*distance/4, #6*distance/4, #7*distance/4
 675 11b8 D0F80061 	>  ldr.w poly4,[poly,#distance]
 675 11bc D0F84071 	>  ldr.w poly5,[poly,#5*distance/4]
 675 11c0 D0F88081 	>  ldr.w poly6,[poly,#6*distance/4]
 675 11c4 D0F8C091 	>  ldr.w poly7,[poly,#7*distance/4]
 676              	
 677              	    _3_layer_double_inv_CT_16 poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, twiddle, twid
 677              	> 
 677 11c8 31F802AB 	>  ldrh.w twiddle,[twiddle_ptr],#2
 677              	>  two_doublebutterfly b,b,poly0,poly1,poly2,poly3,twiddle,tmp,tmp2,q,qinv
 677              	>>  doublebutterfly b,poly0,poly1,twiddle,tmp,tmp2,q,qinv
 677 11cc 13FB0AFC 	>>>  smulbb tmp,poly1,twiddle
 677 11d0 13FB2AF3 	>>>  smultb poly1,poly1,twiddle
 677              	>>>  montgomery q,qinv,tmp,tmp2
 677 11d4 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 677 11d8 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 677              	>>>  montgomery q,qinv,poly1,tmp
 677 11dc 13FB1BFC 	>>>>  smulbt tmp,poly1,qinv
 677 11e0 1BFB0C3C 	>>>>  smlabb tmp,q,tmp,poly1
 677 11e4 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 677 11e8 D2FA4EF3 	>>>  usub16 poly1,poly0,tmp2
 677 11ec 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 677              	>>  doublebutterfly b,poly2,poly3,twiddle,tmp,tmp2,q,qinv
 677 11f0 15FB0AFC 	>>>  smulbb tmp,poly3,twiddle
 677 11f4 15FB2AF5 	>>>  smultb poly3,poly3,twiddle
 677              	>>>  montgomery q,qinv,tmp,tmp2
 677 11f8 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 677 11fc 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 677              	>>>  montgomery q,qinv,poly3,tmp
 677 1200 15FB1BFC 	>>>>  smulbt tmp,poly3,qinv
 677 1204 1BFB0C5C 	>>>>  smlabb tmp,q,tmp,poly3
 677 1208 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 677 120c D4FA4EF5 	>>>  usub16 poly3,poly2,tmp2
 677 1210 94FA4EF4 	>>>  uadd16 poly2,poly2,tmp2
 677              	>  two_doublebutterfly b,b,poly4,poly5,poly6,poly7,twiddle,tmp,tmp2,q,qinv
 677              	>>  doublebutterfly b,poly4,poly5,twiddle,tmp,tmp2,q,qinv
 677 1214 17FB0AFC 	>>>  smulbb tmp,poly5,twiddle
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 40


 677 1218 17FB2AF7 	>>>  smultb poly5,poly5,twiddle
 677              	>>>  montgomery q,qinv,tmp,tmp2
 677 121c 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 677 1220 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 677              	>>>  montgomery q,qinv,poly5,tmp
 677 1224 17FB1BFC 	>>>>  smulbt tmp,poly5,qinv
 677 1228 1BFB0C7C 	>>>>  smlabb tmp,q,tmp,poly5
 677 122c CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 677 1230 D6FA4EF7 	>>>  usub16 poly5,poly4,tmp2
 677 1234 96FA4EF6 	>>>  uadd16 poly4,poly4,tmp2
 677              	>>  doublebutterfly b,poly6,poly7,twiddle,tmp,tmp2,q,qinv
 677 1238 19FB0AFC 	>>>  smulbb tmp,poly7,twiddle
 677 123c 19FB2AF9 	>>>  smultb poly7,poly7,twiddle
 677              	>>>  montgomery q,qinv,tmp,tmp2
 677 1240 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 677 1244 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 677              	>>>  montgomery q,qinv,poly7,tmp
 677 1248 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 677 124c 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 677 1250 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 677 1254 D8FA4EF9 	>>>  usub16 poly7,poly6,tmp2
 677 1258 98FA4EF8 	>>>  uadd16 poly6,poly6,tmp2
 677              	> 
 677              	> 
 677 125c 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 677              	>  two_doublebutterfly b,t,poly0,poly2,poly1,poly3,twiddle,tmp,tmp2,q,qinv
 677              	>>  doublebutterfly b,poly0,poly2,twiddle,tmp,tmp2,q,qinv
 677 1260 14FB0AFC 	>>>  smulbb tmp,poly2,twiddle
 677 1264 14FB2AF4 	>>>  smultb poly2,poly2,twiddle
 677              	>>>  montgomery q,qinv,tmp,tmp2
 677 1268 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 677 126c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 677              	>>>  montgomery q,qinv,poly2,tmp
 677 1270 14FB1BFC 	>>>>  smulbt tmp,poly2,qinv
 677 1274 1BFB0C4C 	>>>>  smlabb tmp,q,tmp,poly2
 677 1278 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 677 127c D2FA4EF4 	>>>  usub16 poly2,poly0,tmp2
 677 1280 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 677              	>>  doublebutterfly t,poly1,poly3,twiddle,tmp,tmp2,q,qinv
 677 1284 15FB1AFC 	>>>  smulbt tmp,poly3,twiddle
 677 1288 15FB3AF5 	>>>  smultt poly3,poly3,twiddle
 677              	>>>  montgomery q,qinv,tmp,tmp2
 677 128c 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 677 1290 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 677              	>>>  montgomery q,qinv,poly3,tmp
 677 1294 15FB1BFC 	>>>>  smulbt tmp,poly3,qinv
 677 1298 1BFB0C5C 	>>>>  smlabb tmp,q,tmp,poly3
 677 129c CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 677 12a0 D3FA4EF5 	>>>  usub16 poly3,poly1,tmp2
 677 12a4 93FA4EF3 	>>>  uadd16 poly1,poly1,tmp2
 677              	> 
 677              	>  two_doublebutterfly b,t,poly4,poly6,poly5,poly7,twiddle,tmp,tmp2,q,qinv
 677              	>>  doublebutterfly b,poly4,poly6,twiddle,tmp,tmp2,q,qinv
 677 12a8 18FB0AFC 	>>>  smulbb tmp,poly6,twiddle
 677 12ac 18FB2AF8 	>>>  smultb poly6,poly6,twiddle
 677              	>>>  montgomery q,qinv,tmp,tmp2
 677 12b0 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 41


 677 12b4 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 677              	>>>  montgomery q,qinv,poly6,tmp
 677 12b8 18FB1BFC 	>>>>  smulbt tmp,poly6,qinv
 677 12bc 1BFB0C8C 	>>>>  smlabb tmp,q,tmp,poly6
 677 12c0 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 677 12c4 D6FA4EF8 	>>>  usub16 poly6,poly4,tmp2
 677 12c8 96FA4EF6 	>>>  uadd16 poly4,poly4,tmp2
 677              	>>  doublebutterfly t,poly5,poly7,twiddle,tmp,tmp2,q,qinv
 677 12cc 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 677 12d0 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 677              	>>>  montgomery q,qinv,tmp,tmp2
 677 12d4 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 677 12d8 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 677              	>>>  montgomery q,qinv,poly7,tmp
 677 12dc 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 677 12e0 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 677 12e4 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 677 12e8 D7FA4EF9 	>>>  usub16 poly7,poly5,tmp2
 677 12ec 97FA4EF7 	>>>  uadd16 poly5,poly5,tmp2
 677              	> 
 677              	> 
 677 12f0 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 677              	>  two_doublebutterfly b,t,poly0,poly4,poly1,poly5,twiddle,tmp,tmp2,q,qinv
 677              	>>  doublebutterfly b,poly0,poly4,twiddle,tmp,tmp2,q,qinv
 677 12f4 16FB0AFC 	>>>  smulbb tmp,poly4,twiddle
 677 12f8 16FB2AF6 	>>>  smultb poly4,poly4,twiddle
 677              	>>>  montgomery q,qinv,tmp,tmp2
 677 12fc 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 677 1300 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 677              	>>>  montgomery q,qinv,poly4,tmp
 677 1304 16FB1BFC 	>>>>  smulbt tmp,poly4,qinv
 677 1308 1BFB0C6C 	>>>>  smlabb tmp,q,tmp,poly4
 677 130c CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 677 1310 D2FA4EF6 	>>>  usub16 poly4,poly0,tmp2
 677 1314 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 677              	>>  doublebutterfly t,poly1,poly5,twiddle,tmp,tmp2,q,qinv
 677 1318 17FB1AFC 	>>>  smulbt tmp,poly5,twiddle
 677 131c 17FB3AF7 	>>>  smultt poly5,poly5,twiddle
 677              	>>>  montgomery q,qinv,tmp,tmp2
 677 1320 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 677 1324 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 677              	>>>  montgomery q,qinv,poly5,tmp
 677 1328 17FB1BFC 	>>>>  smulbt tmp,poly5,qinv
 677 132c 1BFB0C7C 	>>>>  smlabb tmp,q,tmp,poly5
 677 1330 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 677 1334 D3FA4EF7 	>>>  usub16 poly5,poly1,tmp2
 677 1338 93FA4EF3 	>>>  uadd16 poly1,poly1,tmp2
 677              	> 
 677 133c 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 677              	>  two_doublebutterfly b,t,poly2,poly6,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 677              	>>  doublebutterfly b,poly2,poly6,twiddle,tmp,tmp2,q,qinv
 677 1340 18FB0AFC 	>>>  smulbb tmp,poly6,twiddle
 677 1344 18FB2AF8 	>>>  smultb poly6,poly6,twiddle
 677              	>>>  montgomery q,qinv,tmp,tmp2
 677 1348 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 677 134c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 677              	>>>  montgomery q,qinv,poly6,tmp
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 42


 677 1350 18FB1BFC 	>>>>  smulbt tmp,poly6,qinv
 677 1354 1BFB0C8C 	>>>>  smlabb tmp,q,tmp,poly6
 677 1358 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 677 135c D4FA4EF8 	>>>  usub16 poly6,poly2,tmp2
 677 1360 94FA4EF4 	>>>  uadd16 poly2,poly2,tmp2
 677              	>>  doublebutterfly t,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 677 1364 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 677 1368 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 677              	>>>  montgomery q,qinv,tmp,tmp2
 677 136c 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 677 1370 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 677              	>>>  montgomery q,qinv,poly7,tmp
 677 1374 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 677 1378 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 677 137c CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 677 1380 D5FA4EF9 	>>>  usub16 poly7,poly3,tmp2
 677 1384 95FA4EF5 	>>>  uadd16 poly3,poly3,tmp2
 678              	
 679 1388 01EE100A 	    vmov.w s2, poly
 680 138c 43F6ED00 	    movw poly, #:lower16:5585133
 681 1390 C0F25500 	    movt poly, #:upper16:5585133
 682              	
 683              	    // twisting
 684              	    _3_layer_double_inv_twist_16 poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, twiddle, t
 684              	> 
 684 1394 C0F2000B 	>  movt q,#0
 684              	> 
 684 1398 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 684              	> 
 684              	>  mul_twiddle_barrett_32 b,poly0,twiddle,poly,q,tmp,tmp2
 684 139c 12FB0AFC 	>>  smulbb tmp,poly0,twiddle
 684 13a0 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 684 13a4 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 684 13a8 12FB2AF2 	>>  smultb poly0,poly0,twiddle
 684 13ac 52FB10FE 	>>  smmulr.w tmp2,poly0,poly
 684 13b0 0EFB1B22 	>>  mls.w poly0,tmp2,q,poly0
 684 13b4 CCEA0242 	>>  pkhbt poly0,tmp,poly0,lsl#16
 684              	>  mul_twiddle_barrett_32 t,poly1,twiddle,poly,q,tmp,tmp2
 684 13b8 13FB1AFC 	>>  smulbt tmp,poly1,twiddle
 684 13bc 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 684 13c0 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 684 13c4 13FB3AF3 	>>  smultt poly1,poly1,twiddle
 684 13c8 53FB10FE 	>>  smmulr.w tmp2,poly1,poly
 684 13cc 0EFB1B33 	>>  mls.w poly1,tmp2,q,poly1
 684 13d0 CCEA0343 	>>  pkhbt poly1,tmp,poly1,lsl#16
 684              	> 
 684 13d4 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 684              	> 
 684              	>  mul_twiddle_barrett_32 b,poly2,twiddle,poly,q,tmp,tmp2
 684 13d8 14FB0AFC 	>>  smulbb tmp,poly2,twiddle
 684 13dc 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 684 13e0 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 684 13e4 14FB2AF4 	>>  smultb poly2,poly2,twiddle
 684 13e8 54FB10FE 	>>  smmulr.w tmp2,poly2,poly
 684 13ec 0EFB1B44 	>>  mls.w poly2,tmp2,q,poly2
 684 13f0 CCEA0444 	>>  pkhbt poly2,tmp,poly2,lsl#16
 684              	>  mul_twiddle_barrett_32 t,poly3,twiddle,poly,q,tmp,tmp2
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 43


 684 13f4 15FB1AFC 	>>  smulbt tmp,poly3,twiddle
 684 13f8 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 684 13fc 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 684 1400 15FB3AF5 	>>  smultt poly3,poly3,twiddle
 684 1404 55FB10FE 	>>  smmulr.w tmp2,poly3,poly
 684 1408 0EFB1B55 	>>  mls.w poly3,tmp2,q,poly3
 684 140c CCEA0545 	>>  pkhbt poly3,tmp,poly3,lsl#16
 684              	> 
 684 1410 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 684              	> 
 684              	>  mul_twiddle_barrett_32 b,poly4,twiddle,poly,q,tmp,tmp2
 684 1414 16FB0AFC 	>>  smulbb tmp,poly4,twiddle
 684 1418 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 684 141c 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 684 1420 16FB2AF6 	>>  smultb poly4,poly4,twiddle
 684 1424 56FB10FE 	>>  smmulr.w tmp2,poly4,poly
 684 1428 0EFB1B66 	>>  mls.w poly4,tmp2,q,poly4
 684 142c CCEA0646 	>>  pkhbt poly4,tmp,poly4,lsl#16
 684              	>  mul_twiddle_barrett_32 t,poly5,twiddle,poly,q,tmp,tmp2
 684 1430 17FB1AFC 	>>  smulbt tmp,poly5,twiddle
 684 1434 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 684 1438 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 684 143c 17FB3AF7 	>>  smultt poly5,poly5,twiddle
 684 1440 57FB10FE 	>>  smmulr.w tmp2,poly5,poly
 684 1444 0EFB1B77 	>>  mls.w poly5,tmp2,q,poly5
 684 1448 CCEA0747 	>>  pkhbt poly5,tmp,poly5,lsl#16
 684              	> 
 684 144c 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 684              	> 
 684              	>  mul_twiddle_barrett_32 b,poly6,twiddle,poly,q,tmp,tmp2
 684 1450 18FB0AFC 	>>  smulbb tmp,poly6,twiddle
 684 1454 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 684 1458 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 684 145c 18FB2AF8 	>>  smultb poly6,poly6,twiddle
 684 1460 58FB10FE 	>>  smmulr.w tmp2,poly6,poly
 684 1464 0EFB1B88 	>>  mls.w poly6,tmp2,q,poly6
 684 1468 CCEA0848 	>>  pkhbt poly6,tmp,poly6,lsl#16
 684              	>  mul_twiddle_barrett_32 t,poly7,twiddle,poly,q,tmp,tmp2
 684 146c 19FB1AFC 	>>  smulbt tmp,poly7,twiddle
 684 1470 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 684 1474 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 684 1478 19FB3AF9 	>>  smultt poly7,poly7,twiddle
 684 147c 59FB10FE 	>>  smmulr.w tmp2,poly7,poly
 684 1480 0EFB1B99 	>>  mls.w poly7,tmp2,q,poly7
 684 1484 CCEA0949 	>>  pkhbt poly7,tmp,poly7,lsl#16
 684              	> 
 684 1488 C0F2FF2B 	>  movt q,#767
 684              	> 
 685              	
 686 148c 11EE100A 	    vmov.w poly, s2
 687              	
 688              	    store poly, poly4, poly5, poly6, poly7, #distance, #5*distance/4, #6*distance/4, #7*distance/4
 688 1490 C0F80061 	>  str.w poly4,[poly,#distance]
 688 1494 C0F84071 	>  str.w poly5,[poly,#5*distance/4]
 688 1498 C0F88081 	>  str.w poly6,[poly,#6*distance/4]
 688 149c C0F8C091 	>  str.w poly7,[poly,#7*distance/4]
 689 14a0 C0F84030 	    str.w poly1, [poly, #distance/4]
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 44


 690 14a4 C0F88040 	    str.w poly2, [poly, #2*distance/4]
 691 14a8 C0F8C050 	    str.w poly3, [poly, #3*distance/4]
 692 14ac 40F8042B 	    str.w poly0, [poly], #4
 693              	
 694 14b0 17EE10CA 	    vmov tmp, s14
 695 14b4 B0EB0C0F 	    cmp.w poly, tmp
 696 14b8 7FF4E8AC 	  bne.w 3b
 697              	
 698              	  // ITER 13-15
 699 14bc 00F10C0C 	  add tmp, poly, #3*strincr
 700 14c0 06EE90CA 	  vmov s13, tmp
 701              	  2:
 702              	    // polys upto 6q
 703              	    load poly, poly0, poly1, poly2, poly3, #0, #distance/4, #2*distance/4, #3*distance/4
 703 14c4 D0F80020 	>  ldr.w poly0,[poly,#0]
 703 14c8 D0F84030 	>  ldr.w poly1,[poly,#distance/4]
 703 14cc D0F88040 	>  ldr.w poly2,[poly,#2*distance/4]
 703 14d0 D0F8C050 	>  ldr.w poly3,[poly,#3*distance/4]
 704              	    load poly, poly4, poly5, poly6, poly7, #distance, #5*distance/4, #6*distance/4, #7*distance/4
 704 14d4 D0F80061 	>  ldr.w poly4,[poly,#distance]
 704 14d8 D0F84071 	>  ldr.w poly5,[poly,#5*distance/4]
 704 14dc D0F88081 	>  ldr.w poly6,[poly,#6*distance/4]
 704 14e0 D0F8C091 	>  ldr.w poly7,[poly,#7*distance/4]
 705              	
 706              	    _3_layer_double_inv_CT_16 poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, twiddle, twid
 706              	> 
 706 14e4 31F802AB 	>  ldrh.w twiddle,[twiddle_ptr],#2
 706              	>  two_doublebutterfly b,b,poly0,poly1,poly2,poly3,twiddle,tmp,tmp2,q,qinv
 706              	>>  doublebutterfly b,poly0,poly1,twiddle,tmp,tmp2,q,qinv
 706 14e8 13FB0AFC 	>>>  smulbb tmp,poly1,twiddle
 706 14ec 13FB2AF3 	>>>  smultb poly1,poly1,twiddle
 706              	>>>  montgomery q,qinv,tmp,tmp2
 706 14f0 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 706 14f4 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 706              	>>>  montgomery q,qinv,poly1,tmp
 706 14f8 13FB1BFC 	>>>>  smulbt tmp,poly1,qinv
 706 14fc 1BFB0C3C 	>>>>  smlabb tmp,q,tmp,poly1
 706 1500 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 706 1504 D2FA4EF3 	>>>  usub16 poly1,poly0,tmp2
 706 1508 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 706              	>>  doublebutterfly b,poly2,poly3,twiddle,tmp,tmp2,q,qinv
 706 150c 15FB0AFC 	>>>  smulbb tmp,poly3,twiddle
 706 1510 15FB2AF5 	>>>  smultb poly3,poly3,twiddle
 706              	>>>  montgomery q,qinv,tmp,tmp2
 706 1514 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 706 1518 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 706              	>>>  montgomery q,qinv,poly3,tmp
 706 151c 15FB1BFC 	>>>>  smulbt tmp,poly3,qinv
 706 1520 1BFB0C5C 	>>>>  smlabb tmp,q,tmp,poly3
 706 1524 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 706 1528 D4FA4EF5 	>>>  usub16 poly3,poly2,tmp2
 706 152c 94FA4EF4 	>>>  uadd16 poly2,poly2,tmp2
 706              	>  two_doublebutterfly b,b,poly4,poly5,poly6,poly7,twiddle,tmp,tmp2,q,qinv
 706              	>>  doublebutterfly b,poly4,poly5,twiddle,tmp,tmp2,q,qinv
 706 1530 17FB0AFC 	>>>  smulbb tmp,poly5,twiddle
 706 1534 17FB2AF7 	>>>  smultb poly5,poly5,twiddle
 706              	>>>  montgomery q,qinv,tmp,tmp2
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 45


 706 1538 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 706 153c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 706              	>>>  montgomery q,qinv,poly5,tmp
 706 1540 17FB1BFC 	>>>>  smulbt tmp,poly5,qinv
 706 1544 1BFB0C7C 	>>>>  smlabb tmp,q,tmp,poly5
 706 1548 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 706 154c D6FA4EF7 	>>>  usub16 poly5,poly4,tmp2
 706 1550 96FA4EF6 	>>>  uadd16 poly4,poly4,tmp2
 706              	>>  doublebutterfly b,poly6,poly7,twiddle,tmp,tmp2,q,qinv
 706 1554 19FB0AFC 	>>>  smulbb tmp,poly7,twiddle
 706 1558 19FB2AF9 	>>>  smultb poly7,poly7,twiddle
 706              	>>>  montgomery q,qinv,tmp,tmp2
 706 155c 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 706 1560 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 706              	>>>  montgomery q,qinv,poly7,tmp
 706 1564 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 706 1568 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 706 156c CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 706 1570 D8FA4EF9 	>>>  usub16 poly7,poly6,tmp2
 706 1574 98FA4EF8 	>>>  uadd16 poly6,poly6,tmp2
 706              	> 
 706              	> 
 706 1578 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 706              	>  two_doublebutterfly b,t,poly0,poly2,poly1,poly3,twiddle,tmp,tmp2,q,qinv
 706              	>>  doublebutterfly b,poly0,poly2,twiddle,tmp,tmp2,q,qinv
 706 157c 14FB0AFC 	>>>  smulbb tmp,poly2,twiddle
 706 1580 14FB2AF4 	>>>  smultb poly2,poly2,twiddle
 706              	>>>  montgomery q,qinv,tmp,tmp2
 706 1584 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 706 1588 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 706              	>>>  montgomery q,qinv,poly2,tmp
 706 158c 14FB1BFC 	>>>>  smulbt tmp,poly2,qinv
 706 1590 1BFB0C4C 	>>>>  smlabb tmp,q,tmp,poly2
 706 1594 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 706 1598 D2FA4EF4 	>>>  usub16 poly2,poly0,tmp2
 706 159c 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 706              	>>  doublebutterfly t,poly1,poly3,twiddle,tmp,tmp2,q,qinv
 706 15a0 15FB1AFC 	>>>  smulbt tmp,poly3,twiddle
 706 15a4 15FB3AF5 	>>>  smultt poly3,poly3,twiddle
 706              	>>>  montgomery q,qinv,tmp,tmp2
 706 15a8 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 706 15ac 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 706              	>>>  montgomery q,qinv,poly3,tmp
 706 15b0 15FB1BFC 	>>>>  smulbt tmp,poly3,qinv
 706 15b4 1BFB0C5C 	>>>>  smlabb tmp,q,tmp,poly3
 706 15b8 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 706 15bc D3FA4EF5 	>>>  usub16 poly3,poly1,tmp2
 706 15c0 93FA4EF3 	>>>  uadd16 poly1,poly1,tmp2
 706              	> 
 706              	>  two_doublebutterfly b,t,poly4,poly6,poly5,poly7,twiddle,tmp,tmp2,q,qinv
 706              	>>  doublebutterfly b,poly4,poly6,twiddle,tmp,tmp2,q,qinv
 706 15c4 18FB0AFC 	>>>  smulbb tmp,poly6,twiddle
 706 15c8 18FB2AF8 	>>>  smultb poly6,poly6,twiddle
 706              	>>>  montgomery q,qinv,tmp,tmp2
 706 15cc 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 706 15d0 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 706              	>>>  montgomery q,qinv,poly6,tmp
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 46


 706 15d4 18FB1BFC 	>>>>  smulbt tmp,poly6,qinv
 706 15d8 1BFB0C8C 	>>>>  smlabb tmp,q,tmp,poly6
 706 15dc CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 706 15e0 D6FA4EF8 	>>>  usub16 poly6,poly4,tmp2
 706 15e4 96FA4EF6 	>>>  uadd16 poly4,poly4,tmp2
 706              	>>  doublebutterfly t,poly5,poly7,twiddle,tmp,tmp2,q,qinv
 706 15e8 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 706 15ec 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 706              	>>>  montgomery q,qinv,tmp,tmp2
 706 15f0 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 706 15f4 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 706              	>>>  montgomery q,qinv,poly7,tmp
 706 15f8 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 706 15fc 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 706 1600 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 706 1604 D7FA4EF9 	>>>  usub16 poly7,poly5,tmp2
 706 1608 97FA4EF7 	>>>  uadd16 poly5,poly5,tmp2
 706              	> 
 706              	> 
 706 160c 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 706              	>  two_doublebutterfly b,t,poly0,poly4,poly1,poly5,twiddle,tmp,tmp2,q,qinv
 706              	>>  doublebutterfly b,poly0,poly4,twiddle,tmp,tmp2,q,qinv
 706 1610 16FB0AFC 	>>>  smulbb tmp,poly4,twiddle
 706 1614 16FB2AF6 	>>>  smultb poly4,poly4,twiddle
 706              	>>>  montgomery q,qinv,tmp,tmp2
 706 1618 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 706 161c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 706              	>>>  montgomery q,qinv,poly4,tmp
 706 1620 16FB1BFC 	>>>>  smulbt tmp,poly4,qinv
 706 1624 1BFB0C6C 	>>>>  smlabb tmp,q,tmp,poly4
 706 1628 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 706 162c D2FA4EF6 	>>>  usub16 poly4,poly0,tmp2
 706 1630 92FA4EF2 	>>>  uadd16 poly0,poly0,tmp2
 706              	>>  doublebutterfly t,poly1,poly5,twiddle,tmp,tmp2,q,qinv
 706 1634 17FB1AFC 	>>>  smulbt tmp,poly5,twiddle
 706 1638 17FB3AF7 	>>>  smultt poly5,poly5,twiddle
 706              	>>>  montgomery q,qinv,tmp,tmp2
 706 163c 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 706 1640 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 706              	>>>  montgomery q,qinv,poly5,tmp
 706 1644 17FB1BFC 	>>>>  smulbt tmp,poly5,qinv
 706 1648 1BFB0C7C 	>>>>  smlabb tmp,q,tmp,poly5
 706 164c CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 706 1650 D3FA4EF7 	>>>  usub16 poly5,poly1,tmp2
 706 1654 93FA4EF3 	>>>  uadd16 poly1,poly1,tmp2
 706              	> 
 706 1658 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 706              	>  two_doublebutterfly b,t,poly2,poly6,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 706              	>>  doublebutterfly b,poly2,poly6,twiddle,tmp,tmp2,q,qinv
 706 165c 18FB0AFC 	>>>  smulbb tmp,poly6,twiddle
 706 1660 18FB2AF8 	>>>  smultb poly6,poly6,twiddle
 706              	>>>  montgomery q,qinv,tmp,tmp2
 706 1664 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 706 1668 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 706              	>>>  montgomery q,qinv,poly6,tmp
 706 166c 18FB1BFC 	>>>>  smulbt tmp,poly6,qinv
 706 1670 1BFB0C8C 	>>>>  smlabb tmp,q,tmp,poly6
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 47


 706 1674 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 706 1678 D4FA4EF8 	>>>  usub16 poly6,poly2,tmp2
 706 167c 94FA4EF4 	>>>  uadd16 poly2,poly2,tmp2
 706              	>>  doublebutterfly t,poly3,poly7,twiddle,tmp,tmp2,q,qinv
 706 1680 19FB1AFC 	>>>  smulbt tmp,poly7,twiddle
 706 1684 19FB3AF9 	>>>  smultt poly7,poly7,twiddle
 706              	>>>  montgomery q,qinv,tmp,tmp2
 706 1688 1CFB1BFE 	>>>>  smulbt tmp2,tmp,qinv
 706 168c 1BFB0ECE 	>>>>  smlabb tmp2,q,tmp2,tmp
 706              	>>>  montgomery q,qinv,poly7,tmp
 706 1690 19FB1BFC 	>>>>  smulbt tmp,poly7,qinv
 706 1694 1BFB0C9C 	>>>>  smlabb tmp,q,tmp,poly7
 706 1698 CCEA2E4E 	>>>  pkhtb tmp2,tmp,tmp2,asr#16
 706 169c D5FA4EF9 	>>>  usub16 poly7,poly3,tmp2
 706 16a0 95FA4EF5 	>>>  uadd16 poly3,poly3,tmp2
 707              	
 708 16a4 01EE100A 	    vmov.w s2, poly
 709 16a8 43F6ED00 	    movw poly, #:lower16:5585133
 710 16ac C0F25500 	    movt poly, #:upper16:5585133
 711              	
 712              	    // twisting
 713              	    _3_layer_double_inv_twist_16 poly0, poly1, poly2, poly3, poly4, poly5, poly6, poly7, twiddle, t
 713              	> 
 713 16b0 C0F2000B 	>  movt q,#0
 713              	> 
 713 16b4 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 713              	> 
 713              	>  mul_twiddle_barrett_32 b,poly0,twiddle,poly,q,tmp,tmp2
 713 16b8 12FB0AFC 	>>  smulbb tmp,poly0,twiddle
 713 16bc 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 713 16c0 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 713 16c4 12FB2AF2 	>>  smultb poly0,poly0,twiddle
 713 16c8 52FB10FE 	>>  smmulr.w tmp2,poly0,poly
 713 16cc 0EFB1B22 	>>  mls.w poly0,tmp2,q,poly0
 713 16d0 CCEA0242 	>>  pkhbt poly0,tmp,poly0,lsl#16
 713              	>  mul_twiddle_barrett_32 t,poly1,twiddle,poly,q,tmp,tmp2
 713 16d4 13FB1AFC 	>>  smulbt tmp,poly1,twiddle
 713 16d8 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 713 16dc 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 713 16e0 13FB3AF3 	>>  smultt poly1,poly1,twiddle
 713 16e4 53FB10FE 	>>  smmulr.w tmp2,poly1,poly
 713 16e8 0EFB1B33 	>>  mls.w poly1,tmp2,q,poly1
 713 16ec CCEA0343 	>>  pkhbt poly1,tmp,poly1,lsl#16
 713              	> 
 713 16f0 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 713              	> 
 713              	>  mul_twiddle_barrett_32 b,poly2,twiddle,poly,q,tmp,tmp2
 713 16f4 14FB0AFC 	>>  smulbb tmp,poly2,twiddle
 713 16f8 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 713 16fc 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 713 1700 14FB2AF4 	>>  smultb poly2,poly2,twiddle
 713 1704 54FB10FE 	>>  smmulr.w tmp2,poly2,poly
 713 1708 0EFB1B44 	>>  mls.w poly2,tmp2,q,poly2
 713 170c CCEA0444 	>>  pkhbt poly2,tmp,poly2,lsl#16
 713              	>  mul_twiddle_barrett_32 t,poly3,twiddle,poly,q,tmp,tmp2
 713 1710 15FB1AFC 	>>  smulbt tmp,poly3,twiddle
 713 1714 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 48


 713 1718 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 713 171c 15FB3AF5 	>>  smultt poly3,poly3,twiddle
 713 1720 55FB10FE 	>>  smmulr.w tmp2,poly3,poly
 713 1724 0EFB1B55 	>>  mls.w poly3,tmp2,q,poly3
 713 1728 CCEA0545 	>>  pkhbt poly3,tmp,poly3,lsl#16
 713              	> 
 713 172c 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 713              	> 
 713              	>  mul_twiddle_barrett_32 b,poly4,twiddle,poly,q,tmp,tmp2
 713 1730 16FB0AFC 	>>  smulbb tmp,poly4,twiddle
 713 1734 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 713 1738 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 713 173c 16FB2AF6 	>>  smultb poly4,poly4,twiddle
 713 1740 56FB10FE 	>>  smmulr.w tmp2,poly4,poly
 713 1744 0EFB1B66 	>>  mls.w poly4,tmp2,q,poly4
 713 1748 CCEA0646 	>>  pkhbt poly4,tmp,poly4,lsl#16
 713              	>  mul_twiddle_barrett_32 t,poly5,twiddle,poly,q,tmp,tmp2
 713 174c 17FB1AFC 	>>  smulbt tmp,poly5,twiddle
 713 1750 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 713 1754 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 713 1758 17FB3AF7 	>>  smultt poly5,poly5,twiddle
 713 175c 57FB10FE 	>>  smmulr.w tmp2,poly5,poly
 713 1760 0EFB1B77 	>>  mls.w poly5,tmp2,q,poly5
 713 1764 CCEA0747 	>>  pkhbt poly5,tmp,poly5,lsl#16
 713              	> 
 713 1768 51F804AB 	>  ldr.w twiddle,[twiddle_ptr],#4
 713              	> 
 713              	>  mul_twiddle_barrett_32 b,poly6,twiddle,poly,q,tmp,tmp2
 713 176c 18FB0AFC 	>>  smulbb tmp,poly6,twiddle
 713 1770 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 713 1774 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 713 1778 18FB2AF8 	>>  smultb poly6,poly6,twiddle
 713 177c 58FB10FE 	>>  smmulr.w tmp2,poly6,poly
 713 1780 0EFB1B88 	>>  mls.w poly6,tmp2,q,poly6
 713 1784 CCEA0848 	>>  pkhbt poly6,tmp,poly6,lsl#16
 713              	>  mul_twiddle_barrett_32 t,poly7,twiddle,poly,q,tmp,tmp2
 713 1788 19FB1AFC 	>>  smulbt tmp,poly7,twiddle
 713 178c 5CFB10FE 	>>  smmulr.w tmp2,tmp,poly
 713 1790 0EFB1BCC 	>>  mls.w tmp,tmp2,q,tmp
 713 1794 19FB3AF9 	>>  smultt poly7,poly7,twiddle
 713 1798 59FB10FE 	>>  smmulr.w tmp2,poly7,poly
 713 179c 0EFB1B99 	>>  mls.w poly7,tmp2,q,poly7
 713 17a0 CCEA0949 	>>  pkhbt poly7,tmp,poly7,lsl#16
 713              	> 
 713 17a4 C0F2FF2B 	>  movt q,#767
 713              	> 
 714              	
 715 17a8 11EE100A 	    vmov.w poly, s2
 716              	
 717              	    store poly, poly4, poly5, poly6, poly7, #distance, #5*distance/4, #6*distance/4, #7*distance/4
 717 17ac C0F80061 	>  str.w poly4,[poly,#distance]
 717 17b0 C0F84071 	>  str.w poly5,[poly,#5*distance/4]
 717 17b4 C0F88081 	>  str.w poly6,[poly,#6*distance/4]
 717 17b8 C0F8C091 	>  str.w poly7,[poly,#7*distance/4]
 718 17bc C0F84030 	    str.w poly1, [poly, #distance/4]
 719 17c0 C0F88040 	    str.w poly2, [poly, #2*distance/4]
 720 17c4 C0F8C050 	    str.w poly3, [poly, #3*distance/4]
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 49


 721 17c8 40F8042B 	    str.w poly0, [poly], #strincr
 722              	
 723 17cc 16EE90CA 	    vmov tmp, s13
 724 17d0 B0EB0C0F 	    cmp.w poly, tmp
 725 17d4 7FF476AE 	  bne.w 2b
 726              	
 727 17d8 BDE8F08F 	  pop {r4-r11, pc}
 728              	
 729              	.unreq poly
 730              	.unreq twiddle_ptr
 731              	.unreq poly0
 732              	.unreq poly1
 733              	.unreq poly2
 734              	.unreq poly3
 735              	.unreq poly4
 736              	.unreq poly5
 737              	.unreq poly6
 738              	.unreq poly7
 739              	.unreq twiddle
 740              	.unreq qinv
 741              	.unreq q
 742              	.unreq tmp
 743              	.unreq tmp2
 744              	
 745              	.align 2
 746              	.global small_pointmul_asm
 747              	.type small_pointmul_asm, %function
 748              	small_pointmul_asm:
 749 17dc 2DE9F04F 	    push.w {r4-r11, lr}
 750              	
 751 17e0 40F2013E 	    movw r14, #769
 752 17e4 C0F2FF2E 	    movt r14, #767
 753              	
 754              	    .equ width, 4
 755              	
 756 17e8 02F1800C 	    add.w r12, r2, #64*2
 757              	    _point_mul_16_loop:
 758              	
 759 17ec D1F80870 	    ldr.w r7, [r1, #2*width]
 760 17f0 D1F80C80 	    ldr.w r8, [r1, #3*width]
 761 17f4 B2F90290 	    ldrsh.w r9, [r2, #1*2]
 762 17f8 D1F80450 	    ldr.w r5, [r1, #1*width]
 763 17fc 51F8104B 	    ldr.w r4, [r1], #4*width
 764 1800 32F9046B 	    ldrsh.w r6, [r2], #2*2
 765              	
 766 1804 14FB26FA 	    smultb r10, r4, r6
 767              	    montgomery r14, r14, r10, r11
 767 1808 1AFB1EFB 	>  smulbt r11,r10,r14
 767 180c 1EFB0BAB 	>  smlabb r11,r14,r11,r10
 768 1810 C4EA0B04 	    pkhbt r4, r4, r11
 769              	
 770              	
 771 1814 C6F10006 	    neg.w r6, r6
 772              	
 773 1818 15FB26FA 	    smultb r10, r5, r6
 774              	    montgomery r14, r14, r10, r11
 774 181c 1AFB1EFB 	>  smulbt r11,r10,r14
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 50


 774 1820 1EFB0BAB 	>  smlabb r11,r14,r11,r10
 775 1824 C5EA0B05 	    pkhbt r5, r5, r11
 776              	
 777 1828 C0F80450 	    str.w r5, [r0, #1*width]
 778 182c 40F8084B 	    str.w r4, [r0], #2*width
 779              	
 780 1830 17FB29FA 	    smultb r10, r7, r9
 781              	    montgomery r14, r14, r10, r11
 781 1834 1AFB1EFB 	>  smulbt r11,r10,r14
 781 1838 1EFB0BAB 	>  smlabb r11,r14,r11,r10
 782 183c C7EA0B07 	    pkhbt r7, r7, r11
 783              	
 784 1840 C9F10009 	    neg.w r9, r9
 785              	
 786 1844 18FB29FA 	    smultb r10, r8, r9
 787              	    montgomery r14, r14, r10, r11
 787 1848 1AFB1EFB 	>  smulbt r11,r10,r14
 787 184c 1EFB0BAB 	>  smlabb r11,r14,r11,r10
 788 1850 C8EA0B08 	    pkhbt r8, r8, r11
 789              	
 790 1854 C0F80480 	    str.w r8, [r0, #1*width]
 791 1858 40F8087B 	    str.w r7, [r0], #2*width
 792              	
 793 185c B2EB0C0F 	    cmp.w r2, r12
 794 1860 7FF4C4AF 	    bne.w _point_mul_16_loop
 795              	
 796 1864 BDE8F08F 	    pop.w {r4-r11, pc}
 797              	
 798              	  .align 2
 799              	.global small_asymmetric_mul_asm
 800              	.type small_asymmetric_mul_asm, %function
 801              	small_asymmetric_mul_asm:
 802 1868 2DE9F04F 	    push.w {r4-r11, lr}
 803              	
 804 186c 40F2013E 	    movw r14, #769
 805 1870 C0F2FF2E 	    movt r14, #767
 806              	    .equ width, 4
 807 1874 00F5007C 	    add.w r12, r0, #256*2
 808              	    _asymmetric_mul_16_loop:
 809 1878 D1F80470 	    ldr.w r7, [r1, #width]
 810 187c 51F8084B 	    ldr.w r4, [r1], #2*width
 811 1880 D2F80480 	    ldr.w r8, [r2, #width]
 812 1884 52F8085B 	    ldr.w r5, [r2], #2*width
 813 1888 D3F80490 	    ldr.w r9, [r3, #width]
 814 188c 53F8086B 	    ldr.w r6, [r3], #2*width
 815              	
 816 1890 24FB06FA 	    smuad r10, r4, r6
 817              	    montgomery r14, r14, r10, r6
 817 1894 1AFB1EF6 	>  smulbt r6,r10,r14
 817 1898 1EFB06A6 	>  smlabb r6,r14,r6,r10
 818 189c 24FB15FB 	    smuadx r11, r4, r5
 819              	    montgomery r14, r14, r11, r10
 819 18a0 1BFB1EFA 	>  smulbt r10,r11,r14
 819 18a4 1EFB0ABA 	>  smlabb r10,r14,r10,r11
 820              	
 821 18a8 CAEA264A 	    pkhtb r10, r10, r6, asr#16
 822              	
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 51


 823 18ac 40F804AB 	    str.w r10, [r0], #width
 824              	
 825 18b0 27FB09FA 	    smuad r10, r7, r9
 826              	    montgomery r14, r14, r10, r6
 826 18b4 1AFB1EF6 	>  smulbt r6,r10,r14
 826 18b8 1EFB06A6 	>  smlabb r6,r14,r6,r10
 827 18bc 27FB18FB 	    smuadx r11, r7, r8
 828              	    montgomery r14, r14, r11, r10
 828 18c0 1BFB1EFA 	>  smulbt r10,r11,r14
 828 18c4 1EFB0ABA 	>  smlabb r10,r14,r10,r11
 829              	
 830 18c8 CAEA264A 	    pkhtb r10, r10, r6, asr#16
 831 18cc 40F804AB 	    str.w r10, [r0], #width
 832              	
 833              	
 834 18d0 B0EB0C0F 	    cmp.w r0, r12
 835 18d4 7FF4D0AF 	    bne.w _asymmetric_mul_16_loop
 836              	
 837 18d8 BDE8F08F 	    pop.w {r4-r11, pc}...
ARM GAS  C:\Users\Ridwane\AppData\Local\Temp\ccpi3S3G.s 			page 52


DEFINED SYMBOLS
          smallntt.S:112    .text:00000000 small_ntt_asm
          smallntt.S:111    .text:00000000 $t
          smallntt.S:136    *ABS*:00000100 distance
          smallntt.S:137    *ABS*:00000020 offset
          smallntt.S:138    *ABS*:00000004 strincr
          smallntt.S:470    .text:000007d8 small_invntt_tomont_asm
          smallntt.S:748    .text:000017dc small_pointmul_asm
          smallntt.S:754    *ABS*:00000004 width
          smallntt.S:757    .text:000017ec _point_mul_16_loop
          smallntt.S:801    .text:00001868 small_asymmetric_mul_asm
          smallntt.S:808    .text:00001878 _asymmetric_mul_16_loop

NO UNDEFINED SYMBOLS
